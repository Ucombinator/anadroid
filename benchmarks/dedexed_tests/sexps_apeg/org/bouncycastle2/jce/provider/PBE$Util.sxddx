(class (attrs public ) org/bouncycastle2/jce/provider/PBE$Util
 (super java/lang/Object)
 (source "PBE.java")


(method (attrs public ) <init>()void
  (limit registers 1)
  ; this: v0 ([object org/bouncycastle2/jce/provider/PBE$Util])
  (line 44)
  (invoke-direct {v0} java/lang/Object/<init> )
  (return-void )
 )

(method (attrs private static ) makePBEGenerator(int int )[object org/bouncycastle2/crypto/PBEParametersGenerator]
  (limit registers 5)
  ; parameter[0] : v3 (int)
  ; parameter[1] : v4 (int)
  (line 52)
  (if-nez v3 l146c4c)
  (line 54)
  (packed-switch v4 0
    ps146bf4_146c20 ; case 0
    ps146bf4_146c36 ; case 1
    ps146bf4_146bfa ; case 2
    ps146bf4_146bfa ; case 3
    ps146bf4_146bfa ; case 4
    ps146bf4_146c0a ; case 5
    ps146bf4_default) ; default
  (label ps146bf4_default)
  (label ps146bf4_146bfa)
  (line 66)
  (new-instance v1 java/lang/IllegalStateException)
  (const-string v2 "PKCS5 scheme 1 only supports MD2, MD5 and SHA1.")
  (invoke-direct {v1 v2} java/lang/IllegalStateException/<init> [object java/lang/String] )
  (throw v1)
  (label ps146bf4_146c0a)
  (line 57)
  (new-instance v0 org/bouncycastle2/crypto/generators/PKCS5S1ParametersGenerator)
  (new-instance v1 org/bouncycastle2/crypto/digests/MD2Digest)
  (invoke-direct {v1} org/bouncycastle2/crypto/digests/MD2Digest/<init> )
  (invoke-direct {v0 v1} org/bouncycastle2/crypto/generators/PKCS5S1ParametersGenerator/<init> [object org/bouncycastle2/crypto/Digest] )
  (label l146c1e)
  (line 104)
  (return-object v0)
  (label ps146bf4_146c20)
  (label l146c20)
  (line 60)
  (new-instance v0 org/bouncycastle2/crypto/generators/PKCS5S1ParametersGenerator)
  (new-instance v1 org/bouncycastle2/crypto/digests/MD5Digest)
  (invoke-direct {v1} org/bouncycastle2/crypto/digests/MD5Digest/<init> )
  (invoke-direct {v0 v1} org/bouncycastle2/crypto/generators/PKCS5S1ParametersGenerator/<init> [object org/bouncycastle2/crypto/Digest] )
  (label l146c34)
  (line 61)
  (goto l146c1e)
  (label ps146bf4_146c36)
  (label l146c36)
  (line 63)
  (new-instance v0 org/bouncycastle2/crypto/generators/PKCS5S1ParametersGenerator)
  (new-instance v1 org/bouncycastle2/crypto/digests/SHA1Digest)
  (invoke-direct {v1} org/bouncycastle2/crypto/digests/SHA1Digest/<init> )
  (invoke-direct {v0 v1} org/bouncycastle2/crypto/generators/PKCS5S1ParametersGenerator/<init> [object org/bouncycastle2/crypto/Digest] )
  (label l146c4a)
  (line 64)
  (goto l146c1e)
  (label l146c4c)
  (line 69)
  (const/4 v1 1)
  (if-ne v3 v1 l146c5e)
  (line 71)
  (new-instance v0 org/bouncycastle2/crypto/generators/PKCS5S2ParametersGenerator)
  (invoke-direct {v0} org/bouncycastle2/crypto/generators/PKCS5S2ParametersGenerator/<init> )
  (label l146c5c)
  (goto l146c1e)
  (label l146c5e)
  (line 73)
  (const/4 v1 2)
  (if-ne v3 v1 l146cfe)
  (line 75)
  (packed-switch v4 0
    ps146c64_146c90 ; case 0
    ps146c64_146ca6 ; case 1
    ps146c64_146cbc ; case 2
    ps146c64_146cd2 ; case 3
    ps146c64_146ce8 ; case 4
    ps146c64_146c7a ; case 5
    ps146c64_default) ; default
  (label ps146c64_default)
  (line 96)
  (new-instance v1 java/lang/IllegalStateException)
  (const-string v2 "unknown digest scheme for PBE encryption.")
  (invoke-direct {v1 v2} java/lang/IllegalStateException/<init> [object java/lang/String] )
  (throw v1)
  (label ps146c64_146c7a)
  (line 78)
  (new-instance v0 org/bouncycastle2/crypto/generators/PKCS12ParametersGenerator)
  (new-instance v1 org/bouncycastle2/crypto/digests/MD2Digest)
  (invoke-direct {v1} org/bouncycastle2/crypto/digests/MD2Digest/<init> )
  (invoke-direct {v0 v1} org/bouncycastle2/crypto/generators/PKCS12ParametersGenerator/<init> [object org/bouncycastle2/crypto/Digest] )
  (label l146c8e)
  (line 79)
  (goto l146c1e)
  (label ps146c64_146c90)
  (label l146c90)
  (line 81)
  (new-instance v0 org/bouncycastle2/crypto/generators/PKCS12ParametersGenerator)
  (new-instance v1 org/bouncycastle2/crypto/digests/MD5Digest)
  (invoke-direct {v1} org/bouncycastle2/crypto/digests/MD5Digest/<init> )
  (invoke-direct {v0 v1} org/bouncycastle2/crypto/generators/PKCS12ParametersGenerator/<init> [object org/bouncycastle2/crypto/Digest] )
  (label l146ca4)
  (line 82)
  (goto l146c1e)
  (label ps146c64_146ca6)
  (label l146ca6)
  (line 84)
  (new-instance v0 org/bouncycastle2/crypto/generators/PKCS12ParametersGenerator)
  (new-instance v1 org/bouncycastle2/crypto/digests/SHA1Digest)
  (invoke-direct {v1} org/bouncycastle2/crypto/digests/SHA1Digest/<init> )
  (invoke-direct {v0 v1} org/bouncycastle2/crypto/generators/PKCS12ParametersGenerator/<init> [object org/bouncycastle2/crypto/Digest] )
  (label l146cba)
  (line 85)
  (goto l146c1e)
  (label ps146c64_146cbc)
  (label l146cbc)
  (line 87)
  (new-instance v0 org/bouncycastle2/crypto/generators/PKCS12ParametersGenerator)
  (new-instance v1 org/bouncycastle2/crypto/digests/RIPEMD160Digest)
  (invoke-direct {v1} org/bouncycastle2/crypto/digests/RIPEMD160Digest/<init> )
  (invoke-direct {v0 v1} org/bouncycastle2/crypto/generators/PKCS12ParametersGenerator/<init> [object org/bouncycastle2/crypto/Digest] )
  (label l146cd0)
  (line 88)
  (goto l146c1e)
  (label ps146c64_146cd2)
  (label l146cd2)
  (line 90)
  (new-instance v0 org/bouncycastle2/crypto/generators/PKCS12ParametersGenerator)
  (new-instance v1 org/bouncycastle2/crypto/digests/TigerDigest)
  (invoke-direct {v1} org/bouncycastle2/crypto/digests/TigerDigest/<init> )
  (invoke-direct {v0 v1} org/bouncycastle2/crypto/generators/PKCS12ParametersGenerator/<init> [object org/bouncycastle2/crypto/Digest] )
  (label l146ce6)
  (line 91)
  (goto l146c1e)
  (label ps146c64_146ce8)
  (label l146ce8)
  (line 93)
  (new-instance v0 org/bouncycastle2/crypto/generators/PKCS12ParametersGenerator)
  (new-instance v1 org/bouncycastle2/crypto/digests/SHA256Digest)
  (invoke-direct {v1} org/bouncycastle2/crypto/digests/SHA256Digest/<init> )
  (invoke-direct {v0 v1} org/bouncycastle2/crypto/generators/PKCS12ParametersGenerator/<init> [object org/bouncycastle2/crypto/Digest] )
  (label l146cfc)
  (line 94)
  (goto l146c1e)
  (label l146cfe)
  (line 101)
  (new-instance v0 org/bouncycastle2/crypto/generators/OpenSSLPBEParametersGenerator)
  (invoke-direct {v0} org/bouncycastle2/crypto/generators/OpenSSLPBEParametersGenerator/<init> )
  (goto l146c1e)
  (line 54)
  (label l146d0a)
  (data-array
    0x00 0x00
  )
  (line 75)
 )

(method (attrs static ) makePBEMacParameters([object javax/crypto/spec/PBEKeySpec] int int int )[object org/bouncycastle2/crypto/CipherParameters]
  (limit registers 10)
  ; parameter[0] : v6 ([object javax/crypto/spec/PBEKeySpec])
  ; parameter[1] : v7 (int)
  ; parameter[2] : v8 (int)
  ; parameter[3] : v9 (int)
  (line 256)
  (invoke-static {v7 v8} org/bouncycastle2/jce/provider/PBE$Util/makePBEGenerator int int )
  (move-result-object v0)
  (line 260)
  (const/4 v4 2)
  (if-ne v7 v4 l146da2)
  (line 262)
  (invoke-virtual {v6} javax/crypto/spec/PBEKeySpec/getPassword )
  (move-result-object v4)
  (invoke-static {v4} org/bouncycastle2/crypto/PBEParametersGenerator/PKCS12PasswordToBytes [array char] )
  (move-result-object v2)
  (label l146d7a)
  (line 269)
  (invoke-virtual {v6} javax/crypto/spec/PBEKeySpec/getSalt )
  (move-result-object v4)
  (invoke-virtual {v6} javax/crypto/spec/PBEKeySpec/getIterationCount )
  (move-result v5)
  (invoke-virtual {v0 v2 v4 v5} org/bouncycastle2/crypto/PBEParametersGenerator/init [array byte] [array byte] int )
  (line 271)
  (invoke-virtual {v0 v9} org/bouncycastle2/crypto/PBEParametersGenerator/generateDerivedMacParameters int )
  (move-result-object v3)
  (label l146d98)
  (line 273)
  (const/4 v1 0)
  (label l146d9a)
  (array-length v4 v2)
  (if-ne v1 v4 l146db4)
  (line 278)
  (return-object v3)
  (label l146da2)
  (line 266)
  (invoke-virtual {v6} javax/crypto/spec/PBEKeySpec/getPassword )
  (move-result-object v4)
  (invoke-static {v4} org/bouncycastle2/crypto/PBEParametersGenerator/PKCS5PasswordToBytes [array char] )
  (move-result-object v2)
  (goto l146d7a)
  (label l146db4)
  (line 275)
  (const/4 v4 0)
  (aput-byte v4 v2 v1)
  (line 273)
  (add-int/lit8 v1 v1 1)
  (goto l146d9a)
 )

(method (attrs static ) makePBEMacParameters([object org/bouncycastle2/jce/provider/JCEPBEKey] [object java/security/spec/AlgorithmParameterSpec] )[object org/bouncycastle2/crypto/CipherParameters]
  (limit registers 9)
  ; parameter[0] : v7 ([object org/bouncycastle2/jce/provider/JCEPBEKey])
  ; parameter[1] : v8 ([object java/security/spec/AlgorithmParameterSpec])
  (line 175)
  (if-eqz v8 l146ddc)
  (instance-of v5 v8 javax/crypto/spec/PBEParameterSpec)
  (if-nez v5 l146dec)
  (label l146ddc)
  (line 177)
  (new-instance v5 java/lang/IllegalArgumentException)
  (const-string v6 "Need a PBEParameter spec with a PBE key.")
  (invoke-direct {v5 v6} java/lang/IllegalArgumentException/<init> [object java/lang/String] )
  (throw v5)
  (label l146dec)
  (move-object v4 v8)
  (line 180)
  (check-cast v4 [object javax/crypto/spec/PBEParameterSpec])
  (line 181)
  (invoke-virtual {v7} org/bouncycastle2/jce/provider/JCEPBEKey/getType )
  (move-result v5)
  (invoke-virtual {v7} org/bouncycastle2/jce/provider/JCEPBEKey/getDigest )
  (move-result v6)
  (invoke-static {v5 v6} org/bouncycastle2/jce/provider/PBE$Util/makePBEGenerator int int )
  (move-result-object v0)
  (line 182)
  (invoke-virtual {v7} org/bouncycastle2/jce/provider/JCEPBEKey/getEncoded )
  (move-result-object v2)
  (line 185)
  (invoke-virtual {v7} org/bouncycastle2/jce/provider/JCEPBEKey/shouldTryWrongPKCS12 )
  (move-result v5)
  (if-eqz v5 l146e24)
  (line 187)
  (const/4 v5 2)
  (new-array v2 v5 [array byte])
  (label l146e24)
  (line 190)
  (invoke-virtual {v4} javax/crypto/spec/PBEParameterSpec/getSalt )
  (move-result-object v5)
  (invoke-virtual {v4} javax/crypto/spec/PBEParameterSpec/getIterationCount )
  (move-result v6)
  (invoke-virtual {v0 v2 v5 v6} org/bouncycastle2/crypto/PBEParametersGenerator/init [array byte] [array byte] int )
  (line 192)
  (invoke-virtual {v7} org/bouncycastle2/jce/provider/JCEPBEKey/getKeySize )
  (move-result v5)
  (invoke-virtual {v0 v5} org/bouncycastle2/crypto/PBEParametersGenerator/generateDerivedMacParameters int )
  (move-result-object v3)
  (line 194)
  (const/4 v1 0)
  (label l146e4c)
  (array-length v5 v2)
  (if-ne v1 v5 l146e54)
  (line 199)
  (return-object v3)
  (label l146e54)
  (line 196)
  (const/4 v5 0)
  (aput-byte v5 v2 v1)
  (line 194)
  (add-int/lit8 v1 v1 1)
  (goto l146e4c)
 )

(method (attrs static ) makePBEParameters([object javax/crypto/spec/PBEKeySpec] int int int int )[object org/bouncycastle2/crypto/CipherParameters]
  (limit registers 11)
  ; parameter[0] : v6 ([object javax/crypto/spec/PBEKeySpec])
  ; parameter[1] : v7 (int)
  ; parameter[2] : v8 (int)
  ; parameter[3] : v9 (int)
  ; parameter[4] : v10 (int)
  (line 213)
  (invoke-static {v7 v8} org/bouncycastle2/jce/provider/PBE$Util/makePBEGenerator int int )
  (move-result-object v0)
  (line 217)
  (const/4 v4 2)
  (if-ne v7 v4 l146eba)
  (line 219)
  (invoke-virtual {v6} javax/crypto/spec/PBEKeySpec/getPassword )
  (move-result-object v4)
  (invoke-static {v4} org/bouncycastle2/crypto/PBEParametersGenerator/PKCS12PasswordToBytes [array char] )
  (move-result-object v2)
  (label l146e8e)
  (line 226)
  (invoke-virtual {v6} javax/crypto/spec/PBEKeySpec/getSalt )
  (move-result-object v4)
  (invoke-virtual {v6} javax/crypto/spec/PBEKeySpec/getIterationCount )
  (move-result v5)
  (invoke-virtual {v0 v2 v4 v5} org/bouncycastle2/crypto/PBEParametersGenerator/init [array byte] [array byte] int )
  (line 228)
  (if-eqz v10 l146ecc)
  (line 230)
  (invoke-virtual {v0 v9 v10} org/bouncycastle2/crypto/PBEParametersGenerator/generateDerivedParameters int int )
  (move-result-object v3)
  (label l146eb0)
  (line 237)
  (const/4 v1 0)
  (label l146eb2)
  (array-length v4 v2)
  (if-ne v1 v4 l146ed6)
  (line 242)
  (return-object v3)
  (label l146eba)
  (line 223)
  (invoke-virtual {v6} javax/crypto/spec/PBEKeySpec/getPassword )
  (move-result-object v4)
  (invoke-static {v4} org/bouncycastle2/crypto/PBEParametersGenerator/PKCS5PasswordToBytes [array char] )
  (move-result-object v2)
  (goto l146e8e)
  (label l146ecc)
  (line 234)
  (invoke-virtual {v0 v9} org/bouncycastle2/crypto/PBEParametersGenerator/generateDerivedParameters int )
  (move-result-object v3)
  (goto l146eb0)
  (label l146ed6)
  (line 239)
  (const/4 v4 0)
  (aput-byte v4 v2 v1)
  (line 237)
  (add-int/lit8 v1 v1 1)
  (goto l146eb2)
 )

(method (attrs static ) makePBEParameters([object org/bouncycastle2/jce/provider/JCEPBEKey] [object java/security/spec/AlgorithmParameterSpec] [object java/lang/String] )[object org/bouncycastle2/crypto/CipherParameters]
  (limit registers 11)
  ; parameter[0] : v8 ([object org/bouncycastle2/jce/provider/JCEPBEKey])
  ; parameter[1] : v9 ([object java/security/spec/AlgorithmParameterSpec])
  ; parameter[2] : v10 ([object java/lang/String])
  (line 116)
  (if-eqz v9 l146f00)
  (instance-of v6 v9 javax/crypto/spec/PBEParameterSpec)
  (if-nez v6 l146f10)
  (label l146f00)
  (line 118)
  (new-instance v6 java/lang/IllegalArgumentException)
  (const-string v7 "Need a PBEParameter spec with a PBE key.")
  (invoke-direct {v6 v7} java/lang/IllegalArgumentException/<init> [object java/lang/String] )
  (throw v6)
  (label l146f10)
  (move-object v5 v9)
  (line 121)
  (check-cast v5 [object javax/crypto/spec/PBEParameterSpec])
  (line 122)
  (invoke-virtual {v8} org/bouncycastle2/jce/provider/JCEPBEKey/getType )
  (move-result v6)
  (invoke-virtual {v8} org/bouncycastle2/jce/provider/JCEPBEKey/getDigest )
  (move-result v7)
  (invoke-static {v6 v7} org/bouncycastle2/jce/provider/PBE$Util/makePBEGenerator int int )
  (move-result-object v0)
  (line 123)
  (invoke-virtual {v8} org/bouncycastle2/jce/provider/JCEPBEKey/getEncoded )
  (move-result-object v3)
  (line 126)
  (invoke-virtual {v8} org/bouncycastle2/jce/provider/JCEPBEKey/shouldTryWrongPKCS12 )
  (move-result v6)
  (if-eqz v6 l146f48)
  (line 128)
  (const/4 v6 2)
  (new-array v3 v6 [array byte])
  (label l146f48)
  (line 131)
  (invoke-virtual {v5} javax/crypto/spec/PBEParameterSpec/getSalt )
  (move-result-object v6)
  (invoke-virtual {v5} javax/crypto/spec/PBEParameterSpec/getIterationCount )
  (move-result v7)
  (invoke-virtual {v0 v3 v6 v7} org/bouncycastle2/crypto/PBEParametersGenerator/init [array byte] [array byte] int )
  (line 133)
  (invoke-virtual {v8} org/bouncycastle2/jce/provider/JCEPBEKey/getIvSize )
  (move-result v6)
  (if-eqz v6 l146fc4)
  (line 135)
  (invoke-virtual {v8} org/bouncycastle2/jce/provider/JCEPBEKey/getKeySize )
  (move-result v6)
  (invoke-virtual {v8} org/bouncycastle2/jce/provider/JCEPBEKey/getIvSize )
  (move-result v7)
  (invoke-virtual {v0 v6 v7} org/bouncycastle2/crypto/PBEParametersGenerator/generateDerivedParameters int int )
  (move-result-object v4)
  (label l146f82)
  (line 142)
  (const-string v6 "DES")
  (invoke-virtual {v10 v6} java/lang/String/startsWith [object java/lang/String] )
  (move-result v6)
  (if-eqz v6 l146fba)
  (line 144)
  (instance-of v6 v4 org/bouncycastle2/crypto/params/ParametersWithIV)
  (if-eqz v6 l146fd6)
  (move-object v6 v4)
  (line 146)
  (check-cast v6 [object org/bouncycastle2/crypto/params/ParametersWithIV])
  (invoke-virtual {v6} org/bouncycastle2/crypto/params/ParametersWithIV/getParameters )
  (move-result-object v2)
  (check-cast v2 [object org/bouncycastle2/crypto/params/KeyParameter])
  (label l146fac)
  (line 148)
  (invoke-virtual {v2} org/bouncycastle2/crypto/params/KeyParameter/getKey )
  (move-result-object v6)
  (invoke-static {v6} org/bouncycastle2/crypto/params/DESParameters/setOddParity [array byte] )
  (label l146fba)
  (line 158)
  (const/4 v1 0)
  (label l146fbc)
  (array-length v6 v3)
  (if-ne v1 v6 l146fec)
  (line 163)
  (return-object v4)
  (label l146fc4)
  (line 139)
  (invoke-virtual {v8} org/bouncycastle2/jce/provider/JCEPBEKey/getKeySize )
  (move-result v6)
  (invoke-virtual {v0 v6} org/bouncycastle2/crypto/PBEParametersGenerator/generateDerivedParameters int )
  (move-result-object v4)
  (goto l146f82)
  (label l146fd6)
  (move-object v2 v4)
  (line 152)
  (check-cast v2 [object org/bouncycastle2/crypto/params/KeyParameter])
  (label l146fdc)
  (line 154)
  (invoke-virtual {v2} org/bouncycastle2/crypto/params/KeyParameter/getKey )
  (move-result-object v6)
  (invoke-static {v6} org/bouncycastle2/crypto/params/DESParameters/setOddParity [array byte] )
  (goto l146fba)
  (label l146fec)
  (line 160)
  (const/4 v6 0)
  (aput-byte v6 v3 v1)
  (line 158)
  (add-int/lit8 v1 v1 1)
  (goto l146fbc)
 )

)
