(class (attrs public synchronized ) org/bouncycastle/jce/provider/BrokenPBE$Util
 (super java/lang/Object)
 (source "BrokenPBE.java")


(method (attrs public ) <init>()void
  (limit registers 1)
  ; this: v0 ([object org/bouncycastle/jce/provider/BrokenPBE$Util])
  (line 266)
  (invoke-direct-empty {v0} java/lang/Object/<init> )
  (return-void )
 )

(method (attrs private static ) makePBEGenerator(int int )[object org/bouncycastle/crypto/PBEParametersGenerator]
  (limit registers 6)
  ; parameter[0] : v4 (int)
  ; parameter[1] : v5 (int)
  (const-string v3 "unknown digest scheme for PBE encryption.")
  (line 296)
  (if-nez v4 l1dda5a)
  (line 298)
  (packed-switch v5 0
    ps1dda18_1dda2e ; case 0
    ps1dda18_1dda44 ; case 1
    ps1dda18_default) ; default
  (label ps1dda18_default)
  (line 307)
  (new-instance v1 java/lang/IllegalStateException)
  (const-string v2 "PKCS5 scheme 1 only supports only MD5 and SHA1.")
  (invoke-direct {v1 v2} java/lang/IllegalStateException/<init> [object java/lang/String] )
  (throw v1)
  (label ps1dda18_1dda2e)
  (line 301)
  (new-instance v0 org/bouncycastle/crypto/generators/PKCS5S1ParametersGenerator)
  (new-instance v1 org/bouncycastle/crypto/digests/MD5Digest)
  (invoke-direct {v1} org/bouncycastle/crypto/digests/MD5Digest/<init> )
  (invoke-direct {v0 v1} org/bouncycastle/crypto/generators/PKCS5S1ParametersGenerator/<init> [object org/bouncycastle/crypto/Digest] )
  (label l1dda42)
  (line 353)
  (return-object v0)
  (label ps1dda18_1dda44)
  (label l1dda44)
  (line 304)
  (new-instance v0 org/bouncycastle/crypto/generators/PKCS5S1ParametersGenerator)
  (new-instance v1 org/bouncycastle/crypto/digests/SHA1Digest)
  (invoke-direct {v1} org/bouncycastle/crypto/digests/SHA1Digest/<init> )
  (invoke-direct {v0 v1} org/bouncycastle/crypto/generators/PKCS5S1ParametersGenerator/<init> [object org/bouncycastle/crypto/Digest] )
  (label l1dda58)
  (line 305)
  (goto l1dda42)
  (label l1dda5a)
  (line 310)
  (const/4 v1 1)
  (if-ne v4 v1 l1dda6c)
  (line 312)
  (new-instance v0 org/bouncycastle/crypto/generators/PKCS5S2ParametersGenerator)
  (invoke-direct {v0} org/bouncycastle/crypto/generators/PKCS5S2ParametersGenerator/<init> )
  (label l1dda6a)
  (goto l1dda42)
  (label l1dda6c)
  (line 314)
  (const/4 v1 3)
  (if-ne v4 v1 l1ddab4)
  (line 316)
  (packed-switch v5 0
    ps1dda72_1dda88 ; case 0
    ps1dda72_1dda9e ; case 1
    ps1dda72_default) ; default
  (label ps1dda72_default)
  (line 330)
  (new-instance v1 java/lang/IllegalStateException)
  (const-string v2 "unknown digest scheme for PBE encryption.")
  (invoke-direct {v1 v3} java/lang/IllegalStateException/<init> [object java/lang/String] )
  (throw v1)
  (label ps1dda72_1dda88)
  (line 319)
  (new-instance v0 org/bouncycastle/jce/provider/OldPKCS12ParametersGenerator)
  (new-instance v1 org/bouncycastle/crypto/digests/MD5Digest)
  (invoke-direct {v1} org/bouncycastle/crypto/digests/MD5Digest/<init> )
  (invoke-direct {v0 v1} org/bouncycastle/jce/provider/OldPKCS12ParametersGenerator/<init> [object org/bouncycastle/crypto/Digest] )
  (label l1dda9c)
  (line 320)
  (goto l1dda42)
  (label ps1dda72_1dda9e)
  (label l1dda9e)
  (line 322)
  (new-instance v0 org/bouncycastle/jce/provider/OldPKCS12ParametersGenerator)
  (new-instance v1 org/bouncycastle/crypto/digests/SHA1Digest)
  (invoke-direct {v1} org/bouncycastle/crypto/digests/SHA1Digest/<init> )
  (invoke-direct {v0 v1} org/bouncycastle/jce/provider/OldPKCS12ParametersGenerator/<init> [object org/bouncycastle/crypto/Digest] )
  (label l1ddab2)
  (line 323)
  (goto l1dda42)
  (label l1ddab4)
  (line 335)
  (packed-switch v5 0
    ps1ddab4_1ddaca ; case 0
    ps1ddab4_1ddae0 ; case 1
    ps1ddab4_default) ; default
  (label ps1ddab4_default)
  (line 349)
  (new-instance v1 java/lang/IllegalStateException)
  (const-string v2 "unknown digest scheme for PBE encryption.")
  (invoke-direct {v1 v3} java/lang/IllegalStateException/<init> [object java/lang/String] )
  (throw v1)
  (label ps1ddab4_1ddaca)
  (line 338)
  (new-instance v0 org/bouncycastle/crypto/generators/PKCS12ParametersGenerator)
  (new-instance v1 org/bouncycastle/crypto/digests/MD5Digest)
  (invoke-direct {v1} org/bouncycastle/crypto/digests/MD5Digest/<init> )
  (invoke-direct {v0 v1} org/bouncycastle/crypto/generators/PKCS12ParametersGenerator/<init> [object org/bouncycastle/crypto/Digest] )
  (label l1ddade)
  (line 339)
  (goto l1dda42)
  (label ps1ddab4_1ddae0)
  (label l1ddae0)
  (line 341)
  (new-instance v0 org/bouncycastle/crypto/generators/PKCS12ParametersGenerator)
  (new-instance v1 org/bouncycastle/crypto/digests/SHA1Digest)
  (invoke-direct {v1} org/bouncycastle/crypto/digests/SHA1Digest/<init> )
  (invoke-direct {v0 v1} org/bouncycastle/crypto/generators/PKCS12ParametersGenerator/<init> [object org/bouncycastle/crypto/Digest] )
  (line 342)
  (goto l1dda42)
  (line 298)
  (label l1ddaf6)
  (data-array
    0x00 0x00
  )
  (line 316)
  (line 335)
 )

(method (attrs static ) makePBEMacParameters([object org/bouncycastle/jce/provider/JCEPBEKey] [object java/security/spec/AlgorithmParameterSpec] int int int )[object org/bouncycastle/crypto/CipherParameters]
  (limit registers 13)
  ; parameter[0] : v8 ([object org/bouncycastle/jce/provider/JCEPBEKey])
  ; parameter[1] : v9 ([object java/security/spec/AlgorithmParameterSpec])
  ; parameter[2] : v10 (int)
  ; parameter[3] : v11 (int)
  ; parameter[4] : v12 (int)
  (line 426)
  (if-eqz v9 l1ddb44)
  (instance-of v6 v9 javax/crypto/spec/PBEParameterSpec)
  (if-nez v6 l1ddb54)
  (label l1ddb44)
  (line 428)
  (new-instance v6 java/lang/IllegalArgumentException)
  (const-string v7 "Need a PBEParameter spec with a PBE key.")
  (invoke-direct {v6 v7} java/lang/IllegalArgumentException/<init> [object java/lang/String] )
  (throw v6)
  (label l1ddb54)
  (line 431)
  (move-object v0 v9)
  (check-cast v0 [object javax/crypto/spec/PBEParameterSpec])
  (move-object v5 v0)
  (line 432)
  (invoke-static {v10 v11} org/bouncycastle/jce/provider/BrokenPBE$Util/makePBEGenerator int int )
  (move-result-object v1)
  (line 433)
  (invoke-virtual-quick {v8} org/bouncycastle/jce/provider/JCEPBEKey/getEncoded )
  (move-result-object v3)
  (line 436)
  (invoke-virtual-quick {v5} javax/crypto/spec/PBEParameterSpec/getSalt )
  (move-result-object v6)
  (invoke-virtual-quick {v5} javax/crypto/spec/PBEParameterSpec/getIterationCount )
  (move-result v7)
  (invoke-virtual-quick {v1 v3 v6 v7} org/bouncycastle/crypto/PBEParametersGenerator/init [array byte] [array byte] int )
  (line 438)
  (invoke-virtual-quick {v1 v12} org/bouncycastle/crypto/PBEParametersGenerator/generateDerivedMacParameters int )
  (move-result-object v4)
  (line 440)
  (const/4 v2 0)
  (label l1ddb8c)
  (array-length v6 v3)
  (if-eq v2 v6 l1ddb9e)
  (line 442)
  (const/4 v6 0)
  (aput-byte v6 v3 v2)
  (line 440)
  (add-int/lit8 v2 v2 1)
  (goto l1ddb8c)
  (label l1ddb9e)
  (line 445)
  (return-object v4)
 )

(method (attrs static ) makePBEParameters([object org/bouncycastle/jce/provider/JCEPBEKey] [object java/security/spec/AlgorithmParameterSpec] int int [object java/lang/String] int int )[object org/bouncycastle/crypto/CipherParameters]
  (limit registers 16)
  ; parameter[0] : v9 ([object org/bouncycastle/jce/provider/JCEPBEKey])
  ; parameter[1] : v10 ([object java/security/spec/AlgorithmParameterSpec])
  ; parameter[2] : v11 (int)
  ; parameter[3] : v12 (int)
  ; parameter[4] : v13 ([object java/lang/String])
  ; parameter[5] : v14 (int)
  ; parameter[6] : v15 (int)
  (line 369)
  (if-eqz v10 l1ddbbc)
  (instance-of v7 v10 javax/crypto/spec/PBEParameterSpec)
  (if-nez v7 l1ddbcc)
  (label l1ddbbc)
  (line 371)
  (new-instance v7 java/lang/IllegalArgumentException)
  (const-string v8 "Need a PBEParameter spec with a PBE key.")
  (invoke-direct {v7 v8} java/lang/IllegalArgumentException/<init> [object java/lang/String] )
  (throw v7)
  (label l1ddbcc)
  (line 374)
  (move-object v0 v10)
  (check-cast v0 [object javax/crypto/spec/PBEParameterSpec])
  (move-object v6 v0)
  (line 375)
  (invoke-static {v11 v12} org/bouncycastle/jce/provider/BrokenPBE$Util/makePBEGenerator int int )
  (move-result-object v1)
  (line 376)
  (invoke-virtual-quick {v9} org/bouncycastle/jce/provider/JCEPBEKey/getEncoded )
  (move-result-object v4)
  (line 379)
  (invoke-virtual-quick {v6} javax/crypto/spec/PBEParameterSpec/getSalt )
  (move-result-object v7)
  (invoke-virtual-quick {v6} javax/crypto/spec/PBEParameterSpec/getIterationCount )
  (move-result v8)
  (invoke-virtual-quick {v1 v4 v7 v8} org/bouncycastle/crypto/PBEParametersGenerator/init [array byte] [array byte] int )
  (line 381)
  (if-eqz v15 l1ddc54)
  (line 383)
  (invoke-virtual-quick {v1 v14 v15} org/bouncycastle/crypto/PBEParametersGenerator/generateDerivedParameters int int )
  (move-result-object v5)
  (label l1ddc06)
  (line 390)
  (const-string v7 "DES")
  (invoke-virtual-quick {v13 v7} java/lang/String/startsWith [object java/lang/String] )
  (move-result v7)
  (if-eqz v7 l1ddc40)
  (line 392)
  (instance-of v7 v5 org/bouncycastle/crypto/params/ParametersWithIV)
  (if-eqz v7 l1ddc5e)
  (line 394)
  (move-object v0 v5)
  (check-cast v0 [object org/bouncycastle/crypto/params/ParametersWithIV])
  (move-object v7 v0)
  (invoke-virtual-quick {v7} org/bouncycastle/crypto/params/ParametersWithIV/getParameters )
  (move-result-object v3)
  (check-cast v3 [object org/bouncycastle/crypto/params/KeyParameter])
  (label l1ddc32)
  (line 396)
  (invoke-virtual-quick {v3} org/bouncycastle/crypto/params/KeyParameter/getKey )
  (move-result-object v7)
  (invoke-static {v7} org/bouncycastle/jce/provider/BrokenPBE$Util/setOddParity [array byte] )
  (label l1ddc40)
  (line 406)
  (const/4 v2 0)
  (label l1ddc42)
  (array-length v7 v4)
  (if-eq v2 v7 l1ddc76)
  (line 408)
  (const/4 v7 0)
  (aput-byte v7 v4 v2)
  (line 406)
  (add-int/lit8 v2 v2 1)
  (goto l1ddc42)
  (label l1ddc54)
  (line 387)
  (invoke-virtual-quick {v1 v14} org/bouncycastle/crypto/PBEParametersGenerator/generateDerivedParameters int )
  (move-result-object v5)
  (goto l1ddc06)
  (label l1ddc5e)
  (line 400)
  (move-object v0 v5)
  (check-cast v0 [object org/bouncycastle/crypto/params/KeyParameter])
  (move-object v3 v0)
  (label l1ddc66)
  (line 402)
  (invoke-virtual-quick {v3} org/bouncycastle/crypto/params/KeyParameter/getKey )
  (move-result-object v7)
  (invoke-static {v7} org/bouncycastle/jce/provider/BrokenPBE$Util/setOddParity [array byte] )
  (goto l1ddc40)
  (label l1ddc76)
  (line 411)
  (return-object v5)
 )

(method (attrs private static ) setOddParity([array byte] )void
  (limit registers 6)
  ; parameter[0] : v5 ([array byte])
  (line 276)
  (const/4 v1 0)
  (label l1ddc8a)
  (array-length v2 v5)
  (if-ge v1 v2 l1ddcd2)
  (line 278)
  (aget-byte v0 v5 v1)
  (label l1ddc94)
  (line 279)
  (and-int/lit16 v2 v0 254)
  (shr-int/lit8 v3 v0 1)
  (shr-int/lit8 v4 v0 2)
  (xor-int/2addr v3 v4)
  (shr-int/lit8 v4 v0 3)
  (xor-int/2addr v3 v4)
  (shr-int/lit8 v4 v0 4)
  (xor-int/2addr v3 v4)
  (shr-int/lit8 v4 v0 5)
  (xor-int/2addr v3 v4)
  (shr-int/lit8 v4 v0 6)
  (xor-int/2addr v3 v4)
  (shr-int/lit8 v4 v0 7)
  (xor-int/2addr v3 v4)
  (xor-int/lit8 v3 v3 1)
  (or-int/2addr v2 v3)
  (int-to-byte v2 v2)
  (aput-byte v2 v5 v1)
  (line 276)
  (add-int/lit8 v1 v1 1)
  (goto l1ddc8a)
  (label l1ddcd2)
  (line 288)
  (return-void )
 )

)
