(class (attrs final ) org/bouncycastle2/openssl/PEMUtilities
 (super java/lang/Object)
 (source "PEMUtilities.java")


(method (attrs ) <init>()void
  (limit registers 1)
  ; this: v0 ([object org/bouncycastle2/openssl/PEMUtilities])
  (line 15)
  (invoke-direct {v0} java/lang/Object/<init> )
  (return-void )
 )

(method (attrs static ) crypt(boolean [object java/lang/String] [array byte] [array char] [object java/lang/String] [array byte] )[array byte]
  (annotation systemVisibility [object dalvik/annotation/Throws]
    (value [array [object java/lang/String]] [object java/io/IOException])
  )
  (limit registers 23)
  ; parameter[0] : v17 (boolean)
  ; parameter[1] : v18 ([object java/lang/String])
  ; parameter[2] : v19 ([array byte])
  ; parameter[3] : v20 ([array char])
  ; parameter[4] : v21 ([object java/lang/String])
  ; parameter[5] : v22 ([array byte])
  (catch java/lang/Exception from l19ad16 to l19ad1c using l19ad20)
  (catch java/lang/Exception from l19ab38 to l19ab5e using l19ad20)
  (line 26)
  (new-instance v10 javax/crypto/spec/IvParameterSpec)
  (move-object/from16 v0 v22)
  (invoke-direct {v10 v0} javax/crypto/spec/IvParameterSpec/<init> [array byte] )
  (label l19aa32)
  (line 28)
  (const-string v3 "CBC")
  (line 29)
  (const-string v9 "PKCS5Padding")
  (line 34)
  (const-string v14 "-CFB")
  (move-object/from16 v0 v21)
  (invoke-virtual {v0 v14} java/lang/String/endsWith [object java/lang/String] )
  (move-result v14)
  (if-eqz v14 l19aa56)
  (line 36)
  (const-string v3 "CFB")
  (line 37)
  (const-string v9 "NoPadding")
  (label l19aa56)
  (line 39)
  (const-string v14 "-ECB")
  (move-object/from16 v0 v21)
  (invoke-virtual {v0 v14} java/lang/String/endsWith [object java/lang/String] )
  (move-result v14)
  (if-nez v14 l19aa92)
  (line 40)
  (const-string v14 "DES-EDE")
  (move-object/from16 v0 v21)
  (invoke-virtual {v14 v0} java/lang/String/equals [object java/lang/Object] )
  (move-result v14)
  (if-nez v14 l19aa92)
  (line 41)
  (const-string v14 "DES-EDE3")
  (move-object/from16 v0 v21)
  (invoke-virtual {v14 v0} java/lang/String/equals [object java/lang/Object] )
  (move-result v14)
  (if-eqz v14 l19aa98)
  (label l19aa92)
  (line 45)
  (const-string v3 "ECB")
  (line 46)
  (const/4 v10 0)
  (label l19aa98)
  (line 48)
  (const-string v14 "-OFB")
  (move-object/from16 v0 v21)
  (invoke-virtual {v0 v14} java/lang/String/endsWith [object java/lang/String] )
  (move-result v14)
  (if-eqz v14 l19aab4)
  (line 50)
  (const-string v3 "OFB")
  (line 51)
  (const-string v9 "NoPadding")
  (label l19aab4)
  (line 56)
  (const-string v14 "DES-EDE")
  (move-object/from16 v0 v21)
  (invoke-virtual {v0 v14} java/lang/String/startsWith [object java/lang/String] )
  (move-result v14)
  (if-eqz v14 l19ab66)
  (line 58)
  (const-string v2 "DESede")
  (label l19aacc)
  (line 61)
  (const-string v14 "DES-EDE3")
  (move-object/from16 v0 v21)
  (invoke-virtual {v0 v14} java/lang/String/startsWith [object java/lang/String] )
  (move-result v14)
  (if-eqz v14 l19ab62)
  (const/4 v5 0)
  (label l19aae2)
  (line 62)
  (const/16 v14 24)
  (move-object/from16 v0 v20)
  (move-object/from16 v1 v22)
  (invoke-static {v0 v2 v14 v1 v5} org/bouncycastle2/openssl/PEMUtilities/getKey [array char] [object java/lang/String] int [array byte] boolean )
  (move-result-object v11)
  (label l19aaf6)
  (line 130)
  (new-instance v14 java/lang/StringBuilder)
  (invoke-static {v2} java/lang/String/valueOf [object java/lang/Object] )
  (move-result-object v15)
  (invoke-direct {v14 v15} java/lang/StringBuilder/<init> [object java/lang/String] )
  (const-string v15 "/")
  (invoke-virtual {v14 v15} java/lang/StringBuilder/append [object java/lang/String] )
  (move-result-object v14)
  (invoke-virtual {v14 v3} java/lang/StringBuilder/append [object java/lang/String] )
  (move-result-object v14)
  (const-string v15 "/")
  (invoke-virtual {v14 v15} java/lang/StringBuilder/append [object java/lang/String] )
  (move-result-object v14)
  (invoke-virtual {v14 v9} java/lang/StringBuilder/append [object java/lang/String] )
  (move-result-object v14)
  (invoke-virtual {v14} java/lang/StringBuilder/toString )
  (move-result-object v13)
  (label l19ab38)
  (line 134)
  (move-object/from16 v0 v18)
  (invoke-static {v13 v0} javax/crypto/Cipher/getInstance [object java/lang/String] [object java/lang/String] )
  (move-result-object v4)
  (label l19ab44)
  (line 135)
  (if-eqz v17 l19ad10)
  (const/4 v8 1)
  (label l19ab4a)
  (line 137)
  (if-nez v10 l19ad16)
  (line 139)
  (invoke-virtual {v4 v8 v11} javax/crypto/Cipher/init int [object java/security/Key] )
  (label l19ab54)
  (line 145)
  (move-object/from16 v0 v19)
  (invoke-virtual {v4 v0} javax/crypto/Cipher/doFinal [array byte] )
  (label l19ab5e)
  (move-result-object v14)
  (return-object v14)
  (label l19ab62)
  (line 61)
  (const/4 v5 1)
  (goto l19aae2)
  (label l19ab66)
  (line 64)
  (const-string v14 "DES-")
  (move-object/from16 v0 v21)
  (invoke-virtual {v0 v14} java/lang/String/startsWith [object java/lang/String] )
  (move-result v14)
  (if-eqz v14 l19ab94)
  (line 66)
  (const-string v2 "DES")
  (label l19ab7e)
  (line 67)
  (const/16 v14 8)
  (move-object/from16 v0 v20)
  (move-object/from16 v1 v22)
  (invoke-static {v0 v2 v14 v1} org/bouncycastle2/openssl/PEMUtilities/getKey [array char] [object java/lang/String] int [array byte] )
  (move-result-object v11)
  (label l19ab92)
  (goto l19aaf6)
  (label l19ab94)
  (line 69)
  (const-string v14 "BF-")
  (move-object/from16 v0 v21)
  (invoke-virtual {v0 v14} java/lang/String/startsWith [object java/lang/String] )
  (move-result v14)
  (if-eqz v14 l19abc2)
  (line 71)
  (const-string v2 "Blowfish")
  (label l19abac)
  (line 72)
  (const/16 v14 16)
  (move-object/from16 v0 v20)
  (move-object/from16 v1 v22)
  (invoke-static {v0 v2 v14 v1} org/bouncycastle2/openssl/PEMUtilities/getKey [array char] [object java/lang/String] int [array byte] )
  (move-result-object v11)
  (label l19abc0)
  (goto l19aaf6)
  (label l19abc2)
  (line 74)
  (const-string v14 "RC2-")
  (move-object/from16 v0 v21)
  (invoke-virtual {v0 v14} java/lang/String/startsWith [object java/lang/String] )
  (move-result v14)
  (if-eqz v14 l19ac48)
  (line 76)
  (const-string v2 "RC2")
  (label l19abda)
  (line 77)
  (const/16 v7 128)
  (label l19abde)
  (line 78)
  (const-string v14 "RC2-40-")
  (move-object/from16 v0 v21)
  (invoke-virtual {v0 v14} java/lang/String/startsWith [object java/lang/String] )
  (move-result v14)
  (if-eqz v14 l19ac1c)
  (line 80)
  (const/16 v7 40)
  (label l19abf6)
  (line 86)
  (div-int/lit8 v14 v7 8)
  (move-object/from16 v0 v20)
  (move-object/from16 v1 v22)
  (invoke-static {v0 v2 v14 v1} org/bouncycastle2/openssl/PEMUtilities/getKey [array char] [object java/lang/String] int [array byte] )
  (move-result-object v11)
  (label l19ac0a)
  (line 87)
  (if-nez v10 l19ac36)
  (line 89)
  (new-instance v10 javax/crypto/spec/RC2ParameterSpec)
  (label l19ac12)
  (invoke-direct {v10 v7} javax/crypto/spec/RC2ParameterSpec/<init> int )
  (label l19ac18)
  (goto/16 l19aaf6)
  (label l19ac1c)
  (line 82)
  (const-string v14 "RC2-64-")
  (move-object/from16 v0 v21)
  (invoke-virtual {v0 v14} java/lang/String/startsWith [object java/lang/String] )
  (move-result v14)
  (if-eqz v14 l19abf6)
  (line 84)
  (const/16 v7 64)
  (goto l19abf6)
  (label l19ac36)
  (line 93)
  (new-instance v10 javax/crypto/spec/RC2ParameterSpec)
  (label l19ac3a)
  (move-object/from16 v0 v22)
  (invoke-direct {v10 v7 v0} javax/crypto/spec/RC2ParameterSpec/<init> int [array byte] )
  (goto/16 l19aaf6)
  (label l19ac48)
  (line 96)
  (const-string v14 "AES-")
  (move-object/from16 v0 v21)
  (invoke-virtual {v0 v14} java/lang/String/startsWith [object java/lang/String] )
  (move-result v14)
  (if-eqz v14 l19ad00)
  (line 98)
  (const-string v2 "AES")
  (label l19ac60)
  (line 99)
  (move-object/from16 v12 v22)
  (label l19ac64)
  (line 100)
  (array-length v14 v12)
  (const/16 v15 8)
  (if-le v14 v15 l19ac8c)
  (line 102)
  (const/16 v14 8)
  (new-array v12 v14 [array byte])
  (line 103)
  (const/4 v14 0)
  (const/4 v15 0)
  (const/16 v16 8)
  (move-object/from16 v0 v22)
  (move/from16 v1 v16)
  (invoke-static {v0 v14 v12 v15 v1} java/lang/System/arraycopy [object java/lang/Object] int [object java/lang/Object] int int )
  (label l19ac8c)
  (line 107)
  (const-string v14 "AES-128-")
  (move-object/from16 v0 v21)
  (invoke-virtual {v0 v14} java/lang/String/startsWith [object java/lang/String] )
  (move-result v14)
  (if-eqz v14 l19acbc)
  (line 109)
  (const/16 v7 128)
  (label l19aca4)
  (line 123)
  (const-string v14 "AES")
  (div-int/lit8 v15 v7 8)
  (move-object/from16 v0 v20)
  (invoke-static {v0 v14 v15 v12} org/bouncycastle2/openssl/PEMUtilities/getKey [array char] [object java/lang/String] int [array byte] )
  (move-result-object v11)
  (label l19acb8)
  (goto/16 l19aaf6)
  (label l19acbc)
  (line 111)
  (const-string v14 "AES-192-")
  (move-object/from16 v0 v21)
  (invoke-virtual {v0 v14} java/lang/String/startsWith [object java/lang/String] )
  (move-result v14)
  (if-eqz v14 l19acd6)
  (line 113)
  (const/16 v7 192)
  (label l19acd4)
  (goto l19aca4)
  (label l19acd6)
  (line 115)
  (const-string v14 "AES-256-")
  (move-object/from16 v0 v21)
  (invoke-virtual {v0 v14} java/lang/String/startsWith [object java/lang/String] )
  (move-result v14)
  (if-eqz v14 l19acf0)
  (line 117)
  (const/16 v7 256)
  (label l19acee)
  (goto l19aca4)
  (label l19acf0)
  (line 121)
  (new-instance v14 org/bouncycastle2/openssl/EncryptionException)
  (const-string v15 "unknown AES encryption with private key")
  (invoke-direct {v14 v15} org/bouncycastle2/openssl/EncryptionException/<init> [object java/lang/String] )
  (throw v14)
  (label l19ad00)
  (line 127)
  (new-instance v14 org/bouncycastle2/openssl/EncryptionException)
  (const-string v15 "unknown encryption with private key")
  (invoke-direct {v14 v15} org/bouncycastle2/openssl/EncryptionException/<init> [object java/lang/String] )
  (throw v14)
  (label l19ad10)
  (line 135)
  (const/4 v8 2)
  (goto/16 l19ab4a)
  (label l19ad16)
  (line 143)
  (invoke-virtual {v4 v8 v11 v10} javax/crypto/Cipher/init int [object java/security/Key] [object java/security/spec/AlgorithmParameterSpec] )
  (label l19ad1c)
  (goto/16 l19ab54)
  (label l19ad20)
  (line 147)
  (move-exception v6)
  (line 149)
  (new-instance v14 org/bouncycastle2/openssl/EncryptionException)
  (const-string v15 "exception using cipher - please check password and data.")
  (invoke-direct {v14 v15 v6} org/bouncycastle2/openssl/EncryptionException/<init> [object java/lang/String] [object java/lang/Throwable] )
  (throw v14)
 )

(method (attrs private static ) getKey([array char] [object java/lang/String] int [array byte] )[object javax/crypto/SecretKey]
  (limit registers 5)
  ; parameter[0] : v1 ([array char])
  ; parameter[1] : v2 ([object java/lang/String])
  ; parameter[2] : v3 (int)
  ; parameter[3] : v4 ([array byte])
  (line 159)
  (const/4 v0 0)
  (invoke-static {v1 v2 v3 v4 v0} org/bouncycastle2/openssl/PEMUtilities/getKey [array char] [object java/lang/String] int [array byte] boolean )
  (move-result-object v0)
  (return-object v0)
 )

(method (attrs private static ) getKey([array char] [object java/lang/String] int [array byte] boolean )[object javax/crypto/SecretKey]
  (limit registers 11)
  ; parameter[0] : v6 ([array char])
  ; parameter[1] : v7 ([object java/lang/String])
  ; parameter[2] : v8 (int)
  ; parameter[3] : v9 ([array byte])
  ; parameter[4] : v10 (boolean)
  (line 169)
  (new-instance v2 org/bouncycastle2/crypto/generators/OpenSSLPBEParametersGenerator)
  (invoke-direct {v2} org/bouncycastle2/crypto/generators/OpenSSLPBEParametersGenerator/<init> )
  (line 171)
  (invoke-static {v6} org/bouncycastle2/crypto/PBEParametersGenerator/PKCS5PasswordToBytes [array char] )
  (move-result-object v3)
  (invoke-virtual {v2 v3 v9} org/bouncycastle2/crypto/generators/OpenSSLPBEParametersGenerator/init [array byte] [array byte] )
  (line 174)
  (mul-int/lit8 v3 v8 8)
  (invoke-virtual {v2 v3} org/bouncycastle2/crypto/generators/OpenSSLPBEParametersGenerator/generateDerivedParameters int )
  (move-result-object v1)
  (check-cast v1 [object org/bouncycastle2/crypto/params/KeyParameter])
  (line 175)
  (invoke-virtual {v1} org/bouncycastle2/crypto/params/KeyParameter/getKey )
  (move-result-object v0)
  (line 176)
  (if-eqz v10 l19adc6)
  (array-length v3 v0)
  (const/16 v4 24)
  (if-lt v3 v4 l19adc6)
  (line 179)
  (const/4 v3 0)
  (const/16 v4 16)
  (const/16 v5 8)
  (invoke-static {v0 v3 v0 v4 v5} java/lang/System/arraycopy [object java/lang/Object] int [object java/lang/Object] int int )
  (label l19adc6)
  (line 181)
  (new-instance v3 javax/crypto/spec/SecretKeySpec)
  (invoke-direct {v3 v0 v7} javax/crypto/spec/SecretKeySpec/<init> [array byte] [object java/lang/String] )
  (return-object v3)
 )

)
