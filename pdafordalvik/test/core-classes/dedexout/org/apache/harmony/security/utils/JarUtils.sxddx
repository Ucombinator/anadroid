(class (attrs public synchronized ) org/apache/harmony/security/utils/JarUtils
 (super java/lang/Object)
 (source "JarUtils.java")

 (field (attrs private static final ) MESSAGE_DIGEST_OID [array int] )

(method (attrs static ) <clinit>()void
  (limit registers 1)
  (line 59)
  (const/4 v0 7)
  (new-array v0 v0 [array int])
  (fill-array-data v0 l1ab744)
  (sput-object v0 org/apache/harmony/security/utils/JarUtils.MESSAGE_DIGEST_OID [array int])
  (return-void )
  (label l1ab742)
  (data-array
    0x00 0x00
  )
  (label l1ab744)
  (data-array
    (0x01 0x00 0x00 0x00) ; #0
    (0x02 0x00 0x00 0x00) ; #1
    (0x48 0x03 0x00 0x00) ; #2
    (0x8D 0xBB 0x01 0x00) ; #3
    (0x01 0x00 0x00 0x00) ; #4
    (0x09 0x00 0x00 0x00) ; #5
    (0x04 0x00 0x00 0x00) ; #6
  )
 )

(method (attrs public ) <init>()void
  (limit registers 1)
  ; this: v0 ([object org/apache/harmony/security/utils/JarUtils])
  (line 55)
  (invoke-direct-empty {v0} java/lang/Object/<init> )
  (return-void )
 )

(method (attrs private static ) createChain([object java/security/cert/X509Certificate] [array [object java/security/cert/X509Certificate]] )[array [object java/security/cert/X509Certificate]]
  (limit registers 8)
  ; parameter[0] : v6 ([object java/security/cert/X509Certificate])
  ; parameter[1] : v7 ([array [object java/security/cert/X509Certificate]])
  (line 201)
  (new-instance v0 java/util/LinkedList)
  (invoke-direct {v0} java/util/LinkedList/<init> )
  (line 202)
  (const/4 v4 0)
  (invoke-virtual-quick {v0 v4 v6} java/util/LinkedList/add int [object java/lang/Object] )
  (line 205)
  (invoke-virtual-quick {v6} java/security/cert/X509Certificate/getSubjectDN )
  (move-result-object v4)
  (invoke-virtual-quick {v6} java/security/cert/X509Certificate/getIssuerDN )
  (move-result-object v5)
  (invoke-virtual-quick {v4 v5} java/security/Principal/equals [object java/lang/Object] )
  (move-result v4)
  (if-eqz v4 l1ab7d8)
  (line 206)
  (const/4 v4 1)
  (new-array v4 v4 [array [object java/security/cert/X509Certificate]])
  (invoke-virtual-quick {v0 v4} java/util/LinkedList/toArray [array [object java/lang/Object]] )
  (move-result-object v6)
  (check-cast v6 [array [object java/security/cert/X509Certificate]])
  (check-cast v6 [array [object java/security/cert/X509Certificate]])
  (move-object v4 v6)
  (label l1ab7d6)
  (line 224)
  (return-object v4)
  (label l1ab7d8)
  (line 209)
  (invoke-virtual-quick {v6} java/security/cert/X509Certificate/getIssuerDN )
  (move-result-object v2)
  (line 211)
  (const/4 v1 1)
  (label l1ab7e2)
  (line 213)
  (invoke-static {v2 v7} org/apache/harmony/security/utils/JarUtils/findCert [object java/security/Principal] [array [object java/security/cert/X509Certificate]] )
  (move-result-object v3)
  (line 214)
  (if-nez v3 l1ab806)
  (label l1ab7ee)
  (line 224)
  (new-array v4 v1 [array [object java/security/cert/X509Certificate]])
  (invoke-virtual-quick {v0 v4} java/util/LinkedList/toArray [array [object java/lang/Object]] )
  (move-result-object v6)
  (check-cast v6 [array [object java/security/cert/X509Certificate]])
  (check-cast v6 [array [object java/security/cert/X509Certificate]])
  (move-object v4 v6)
  (goto l1ab7d6)
  (label l1ab806)
  (line 217)
  (invoke-virtual-quick {v0 v3} java/util/LinkedList/add [object java/lang/Object] )
  (line 218)
  (add-int/lit8 v1 v1 1)
  (line 219)
  (invoke-virtual-quick {v3} java/security/cert/X509Certificate/getSubjectDN )
  (move-result-object v4)
  (invoke-virtual-quick {v3} java/security/cert/X509Certificate/getIssuerDN )
  (move-result-object v5)
  (invoke-virtual-quick {v4 v5} java/security/Principal/equals [object java/lang/Object] )
  (move-result v4)
  (if-nez v4 l1ab7ee)
  (line 222)
  (invoke-virtual-quick {v3} java/security/cert/X509Certificate/getIssuerDN )
  (move-result-object v2)
  (goto l1ab7e2)
 )

(method (attrs private static ) findCert([object java/security/Principal] [array [object java/security/cert/X509Certificate]] )[object java/security/cert/X509Certificate]
  (limit registers 4)
  ; parameter[0] : v2 ([object java/security/Principal])
  ; parameter[1] : v3 ([array [object java/security/cert/X509Certificate]])
  (line 228)
  (const/4 v0 0)
  (label l1ab84a)
  (array-length v1 v3)
  (if-ge v0 v1 l1ab874)
  (line 229)
  (aget-object v1 v3 v0)
  (invoke-virtual-quick {v1} java/security/cert/X509Certificate/getSubjectDN )
  (move-result-object v1)
  (invoke-virtual-quick {v2 v1} java/security/Principal/equals [object java/lang/Object] )
  (move-result v1)
  (if-eqz v1 l1ab86e)
  (line 230)
  (aget-object v1 v3 v0)
  (label l1ab86c)
  (line 233)
  (return-object v1)
  (label l1ab86e)
  (line 228)
  (add-int/lit8 v0 v0 1)
  (goto l1ab84a)
  (label l1ab874)
  (line 233)
  (const/4 v1 0)
  (goto l1ab86c)
 )

(method (attrs public static ) verifySignature([object java/io/InputStream] [object java/io/InputStream] )[array [object java/security/cert/Certificate]]
  (annotation systemVisibility [object dalvik/annotation/Throws]
    (value [array [object java/lang/String]] [object java/io/IOException]  [object java/security/GeneralSecurityException])
  )
  (limit registers 9)
  ; parameter[0] : v7 ([object java/io/InputStream])
  ; parameter[1] : v8 ([object java/io/InputStream])
  (catch java/security/NoSuchAlgorithmException from l1aba38 to l1aba3e using l1aba9c)
  (catch java/security/NoSuchAlgorithmException from l1aba1a to l1aba20 using l1aba32)
  (line 76)
  (new-instance v0 org/apache/harmony/security/asn1/BerInputStream)
  (invoke-direct {v0 v8} org/apache/harmony/security/asn1/BerInputStream/<init> [object java/io/InputStream] )
  (label l1ab892)
  (line 77)
  (sget-object v8 org/apache/harmony/security/pkcs7/ContentInfo.ASN1 [object org/apache/harmony/security/asn1/ASN1Sequence])
  (invoke-virtual-quick {v8 v0} org/apache/harmony/security/asn1/ASN1Sequence/decode [object org/apache/harmony/security/asn1/BerInputStream] )
  (move-result-object v8)
  (check-cast v8 [object org/apache/harmony/security/pkcs7/ContentInfo])
  (label l1ab8a2)
  (line 78)
  (invoke-virtual-quick {v8} org/apache/harmony/security/pkcs7/ContentInfo/getSignedData )
  (move-result-object v3)
  (label l1ab8aa)
  (line 79)
  (if-nez v3 l1ab8c6)
  (line 80)
  (new-instance v7 java/io/IOException)
  (const-string v8 "security.173")
  (label l1ab8b6)
  (invoke-static {v8} org/apache/harmony/security/internal/nls/Messages/getString [object java/lang/String] )
  (move-result-object v8)
  (invoke-direct {v7 v8} java/io/IOException/<init> [object java/lang/String] )
  (throw v7)
  (label l1ab8c6)
  (line 82)
  (invoke-virtual-quick {v3} org/apache/harmony/security/pkcs7/SignedData/getCertificates )
  (move-result-object v8)
  (label l1ab8ce)
  (line 83)
  (invoke-interface {v8} java/util/Collection/isEmpty )
  (move-result v0)
  (label l1ab8d6)
  (if-eqz v0 l1ab8de)
  (line 84)
  (const/4 v7 0)
  (label l1ab8dc)
  (line 197)
  (return-object v7)
  (label l1ab8de)
  (line 86)
  (invoke-interface {v8} java/util/Collection/size )
  (move-result v0)
  (new-array v0 v0 [array [object java/security/cert/X509Certificate]])
  (line 87)
  (const/4 v1 0)
  (label l1ab8ec)
  (line 88)
  (invoke-interface {v8} java/util/Collection/iterator )
  (move-result-object v2)
  (move v8 v1)
  (label l1ab8f6)
  (invoke-interface {v2} java/util/Iterator/hasNext )
  (move-result v1)
  (if-eqz v1 l1ab924)
  (line 89)
  (add-int/lit8 v1 v8 1)
  (label l1ab906)
  (new-instance v5 org/apache/harmony/security/provider/cert/X509CertImpl)
  (invoke-interface {v2} java/util/Iterator/next )
  (move-result-object v4)
  (check-cast v4 [object org/apache/harmony/security/x509/Certificate])
  (invoke-direct {v5 v4} org/apache/harmony/security/provider/cert/X509CertImpl/<init> [object org/apache/harmony/security/x509/Certificate] )
  (aput-object v5 v0 v8)
  (move v8 v1)
  (label l1ab922)
  (goto l1ab8f6)
  (label l1ab924)
  (line 92)
  (invoke-virtual-quick {v3} org/apache/harmony/security/pkcs7/SignedData/getSignerInfos )
  (move-result-object v8)
  (line 94)
  (invoke-interface {v8} java/util/List/isEmpty )
  (move-result v1)
  (if-nez v1 l1ab99e)
  (line 95)
  (const/4 v1 0)
  (invoke-interface {v8 v1} java/util/List/get int )
  (move-result-object v5)
  (check-cast v5 [object org/apache/harmony/security/pkcs7/SignerInfo])
  (label l1ab946)
  (line 101)
  (invoke-virtual-quick {v5} org/apache/harmony/security/pkcs7/SignerInfo/getIssuer )
  (move-result-object v1)
  (line 104)
  (invoke-virtual-quick {v5} org/apache/harmony/security/pkcs7/SignerInfo/getSerialNumber )
  (move-result-object v3)
  (line 107)
  (const/4 v2 0)
  (label l1ab958)
  (line 108)
  (const/4 v8 0)
  (label l1ab95a)
  (array-length v4 v0)
  (if-ge v8 v4 l1abb52)
  (line 109)
  (aget-object v4 v0 v8)
  (invoke-virtual-quick {v4} java/security/cert/X509Certificate/getIssuerDN )
  (move-result-object v4)
  (invoke-virtual-quick {v1 v4} javax/security/auth/x500/X500Principal/equals [object java/lang/Object] )
  (move-result v4)
  (if-eqz v4 l1ab9a2)
  (aget-object v4 v0 v8)
  (invoke-virtual-quick {v4} java/security/cert/X509Certificate/getSerialNumber )
  (move-result-object v4)
  (invoke-virtual-quick {v3 v4} java/math/BigInteger/equals [object java/lang/Object] )
  (move-result v4)
  (if-eqz v4 l1ab9a2)
  (line 111)
  (move v1 v8)
  (label l1ab992)
  (move v3 v1)
  (label l1ab994)
  (line 115)
  (array-length v1 v0)
  (if-ne v8 v1 l1ab9a8)
  (line 116)
  (const/4 v7 0)
  (goto l1ab8dc)
  (label l1ab99e)
  (line 97)
  (const/4 v7 0)
  (goto l1ab8dc)
  (label l1ab9a2)
  (line 108)
  (add-int/lit8 v8 v8 1)
  (goto l1ab95a)
  (label l1ab9a8)
  (line 119)
  (aget-object v8 v0 v3)
  (label l1ab9ac)
  (invoke-virtual-quick {v8} java/security/cert/X509Extension/hasUnsupportedCriticalExtension )
  (move-result v8)
  (if-eqz v8 l1ab9d0)
  (line 120)
  (new-instance v7 java/lang/SecurityException)
  (const-string v8 "security.174")
  (invoke-static {v8} org/apache/harmony/security/internal/nls/Messages/getString [object java/lang/String] )
  (move-result-object v8)
  (invoke-direct {v7 v8} java/lang/SecurityException/<init> [object java/lang/String] )
  (throw v7)
  (label l1ab9d0)
  (line 124)
  (const/4 v4 0)
  (label l1ab9d2)
  (line 125)
  (invoke-virtual-quick {v5} org/apache/harmony/security/pkcs7/SignerInfo/getdigestAlgorithm )
  (move-result-object v1)
  (line 126)
  (invoke-virtual-quick {v5} org/apache/harmony/security/pkcs7/SignerInfo/getDigestEncryptionAlgorithm )
  (move-result-object v2)
  (line 127)
  (const/4 v8 0)
  (label l1ab9e4)
  (line 128)
  (if-eqz v1 l1abb4c)
  (if-eqz v2 l1abb4c)
  (line 129)
  (new-instance v8 java/lang/StringBuilder)
  (label l1ab9f0)
  (invoke-direct {v8} java/lang/StringBuilder/<init> )
  (invoke-virtual-quick {v8 v1} java/lang/StringBuilder/append [object java/lang/String] )
  (move-result-object v8)
  (const-string v6 "with")
  (invoke-virtual-quick {v8 v6} java/lang/StringBuilder/append [object java/lang/String] )
  (move-result-object v8)
  (invoke-virtual-quick {v8 v2} java/lang/StringBuilder/append [object java/lang/String] )
  (move-result-object v8)
  (invoke-virtual-quick {v8} java/lang/StringBuilder/toString )
  (move-result-object v8)
  (label l1aba1a)
  (line 135)
  (invoke-static {v8} org/apache/harmony/xnet/provider/jsse/OpenSSLSignature/getInstance [object java/lang/String] )
  (label l1aba20)
  (move-result-object v2)
  (label l1aba22)
  (line 139)
  (if-nez v2 l1abb46)
  (line 140)
  (move-object v8 v1)
  (line 141)
  (if-nez v8 l1aba38)
  (line 142)
  (const/4 v7 0)
  (goto/16 l1ab8dc)
  (label l1aba32)
  (line 137)
  (move-exception v2)
  (label l1aba34)
  (move-object v2 v4)
  (label l1aba36)
  (goto l1aba22)
  (label l1aba38)
  (line 149)
  (invoke-static {v8} org/apache/harmony/xnet/provider/jsse/OpenSSLSignature/getInstance [object java/lang/String] )
  (label l1aba3e)
  (move-result-object v1)
  (label l1aba40)
  (move-object v4 v1)
  (label l1aba42)
  (line 155)
  (aget-object v8 v0 v3)
  (label l1aba46)
  (invoke-virtual-quick {v4 v8} org/apache/harmony/xnet/provider/jsse/OpenSSLSignature/initVerify [object java/security/cert/Certificate] )
  (line 160)
  (invoke-virtual-quick {v5} org/apache/harmony/security/pkcs7/SignerInfo/getAuthenticatedAttributes )
  (move-result-object v8)
  (label l1aba54)
  (line 162)
  (invoke-virtual-quick {v7} java/io/InputStream/available )
  (move-result v1)
  (new-array v2 v1 [array byte])
  (line 163)
  (invoke-virtual-quick {v7 v2} java/io/InputStream/read [array byte] )
  (line 165)
  (if-nez v8 l1abaa4)
  (line 166)
  (invoke-virtual-quick {v4 v2} org/apache/harmony/xnet/provider/jsse/OpenSSLSignature/update [array byte] )
  (label l1aba70)
  (line 193)
  (invoke-virtual-quick {v5} org/apache/harmony/security/pkcs7/SignerInfo/getEncryptedDigest )
  (move-result-object v7)
  (invoke-virtual-quick {v4 v7} org/apache/harmony/xnet/provider/jsse/OpenSSLSignature/verify [array byte] )
  (move-result v7)
  (if-nez v7 l1abb36)
  (line 194)
  (new-instance v7 java/lang/SecurityException)
  (const-string v8 "security.176")
  (invoke-static {v8} org/apache/harmony/security/internal/nls/Messages/getString [object java/lang/String] )
  (move-result-object v8)
  (invoke-direct {v7 v8} java/lang/SecurityException/<init> [object java/lang/String] )
  (throw v7)
  (label l1aba9c)
  (line 151)
  (move-exception v7)
  (line 152)
  (const/4 v7 0)
  (goto/16 l1ab8dc)
  (label l1abaa4)
  (line 168)
  (invoke-virtual-quick {v5} org/apache/harmony/security/pkcs7/SignerInfo/getEncodedAuthenticatedAttributes )
  (move-result-object v7)
  (label l1abaac)
  (invoke-virtual-quick {v4 v7} org/apache/harmony/xnet/provider/jsse/OpenSSLSignature/update [array byte] )
  (line 172)
  (const/4 v1 0)
  (label l1abab4)
  (line 173)
  (invoke-interface {v8} java/util/List/iterator )
  (move-result-object v8)
  (label l1ababc)
  (invoke-interface {v8} java/util/Iterator/hasNext )
  (move-result v7)
  (if-eqz v7 l1abaf6)
  (line 174)
  (invoke-interface {v8} java/util/Iterator/next )
  (move-result-object v7)
  (check-cast v7 [object org/apache/harmony/security/x501/AttributeTypeAndValue])
  (label l1abad4)
  (line 175)
  (invoke-virtual-quick {v7} org/apache/harmony/security/x501/AttributeTypeAndValue/getType )
  (move-result-object v7)
  (label l1abadc)
  (invoke-virtual-quick {v7} org/apache/harmony/security/utils/ObjectIdentifier/getOid )
  (move-result-object v7)
  (sget-object v6 org/apache/harmony/security/utils/JarUtils.MESSAGE_DIGEST_OID [array int])
  (invoke-static {v7 v6} java/util/Arrays/equals [array int] [array int] )
  (move-result v7)
  (if-eqz v7 l1ababc)
  (goto l1ababc)
  (label l1abaf6)
  (line 179)
  (if-eqz v1 l1aba70)
  (line 184)
  (invoke-virtual-quick {v5} org/apache/harmony/security/pkcs7/SignerInfo/getDigestAlgorithm )
  (move-result-object v7)
  (invoke-static {v7} org/apache/harmony/xnet/provider/jsse/OpenSSLMessageDigestJDK/getInstance [object java/lang/String] )
  (move-result-object v7)
  (line 186)
  (invoke-virtual-quick {v7 v2} org/apache/harmony/xnet/provider/jsse/OpenSSLMessageDigestJDK/digest [array byte] )
  (move-result-object v7)
  (label l1abb12)
  (line 187)
  (invoke-static {v1 v7} java/util/Arrays/equals [array byte] [array byte] )
  (move-result v7)
  (label l1abb1a)
  (if-nez v7 l1aba70)
  (line 188)
  (new-instance v7 java/lang/SecurityException)
  (const-string v8 "security.175")
  (label l1abb26)
  (invoke-static {v8} org/apache/harmony/security/internal/nls/Messages/getString [object java/lang/String] )
  (move-result-object v8)
  (invoke-direct {v7 v8} java/lang/SecurityException/<init> [object java/lang/String] )
  (throw v7)
  (label l1abb36)
  (line 197)
  (aget-object v7 v0 v3)
  (invoke-static {v7 v0} org/apache/harmony/security/utils/JarUtils/createChain [object java/security/cert/X509Certificate] [array [object java/security/cert/X509Certificate]] )
  (move-result-object v7)
  (goto/16 l1ab8dc)
  (label l1abb46)
  (move-object v4 v2)
  (label l1abb48)
  (goto/16 l1aba42)
  (label l1abb4c)
  (move-object v2 v4)
  (label l1abb4e)
  (goto/16 l1aba22)
  (label l1abb52)
  (move v3 v2)
  (label l1abb54)
  (goto/16 l1ab994)
 )

)
