(class (attrs public ) org/bouncycastle2/openpgp/examples/SignedFileProcessor
 (super java/lang/Object)
 (source "SignedFileProcessor.java")


(method (attrs public ) <init>()void
  (limit registers 1)
  ; this: v0 ([object org/bouncycastle2/openpgp/examples/SignedFileProcessor])
  (line 54)
  (invoke-direct {v0} java/lang/Object/<init> )
  (return-void )
 )

(method (attrs public static ) main([array [object java/lang/String]] )void
  (annotation systemVisibility [object dalvik/annotation/Throws]
    (value [array [object java/lang/String]] [object java/lang/Exception])
  )
  (limit registers 10)
  ; parameter[0] : v9 ([array [object java/lang/String]])
  (const/4 v8 3)
  (const/4 v7 0)
  (const/4 v6 2)
  (const/4 v5 1)
  (line 233)
  (new-instance v3 org/bouncycastle2/jce/provider/BouncyCastleProvider)
  (invoke-direct {v3} org/bouncycastle2/jce/provider/BouncyCastleProvider/<init> )
  (invoke-static {v3} java/security/Security/addProvider [object java/security/Provider] )
  (line 235)
  (aget-object v3 v9 v7)
  (const-string v4 "-s")
  (invoke-virtual {v3 v4} java/lang/String/equals [object java/lang/Object] )
  (move-result v3)
  (if-eqz v3 l192186)
  (line 237)
  (aget-object v3 v9 v5)
  (const-string v4 "-a")
  (invoke-virtual {v3 v4} java/lang/String/equals [object java/lang/Object] )
  (move-result v3)
  (if-eqz v3 l19212c)
  (line 239)
  (new-instance v1 java/io/FileInputStream)
  (aget-object v3 v9 v8)
  (invoke-direct {v1 v3} java/io/FileInputStream/<init> [object java/lang/String] )
  (label l1920de)
  (line 240)
  (new-instance v2 java/io/FileOutputStream)
  (new-instance v3 java/lang/StringBuilder)
  (aget-object v4 v9 v6)
  (invoke-static {v4} java/lang/String/valueOf [object java/lang/Object] )
  (move-result-object v4)
  (invoke-direct {v3 v4} java/lang/StringBuilder/<init> [object java/lang/String] )
  (const-string v4 ".asc")
  (invoke-virtual {v3 v4} java/lang/StringBuilder/append [object java/lang/String] )
  (move-result-object v3)
  (invoke-virtual {v3} java/lang/StringBuilder/toString )
  (move-result-object v3)
  (invoke-direct {v2 v3} java/io/FileOutputStream/<init> [object java/lang/String] )
  (label l192112)
  (line 242)
  (aget-object v3 v9 v6)
  (const/4 v4 4)
  (aget-object v4 v9 v4)
  (invoke-virtual {v4} java/lang/String/toCharArray )
  (move-result-object v4)
  (invoke-static {v3 v1 v2 v4 v5} org/bouncycastle2/openpgp/examples/SignedFileProcessor/signFile [object java/lang/String] [object java/io/InputStream] [object java/io/OutputStream] [array char] boolean )
  (label l19212a)
  (line 263)
  (return-void )
  (label l19212c)
  (line 246)
  (new-instance v1 java/io/FileInputStream)
  (aget-object v3 v9 v6)
  (invoke-direct {v1 v3} java/io/FileInputStream/<init> [object java/lang/String] )
  (label l19213a)
  (line 247)
  (new-instance v2 java/io/FileOutputStream)
  (new-instance v3 java/lang/StringBuilder)
  (aget-object v4 v9 v5)
  (invoke-static {v4} java/lang/String/valueOf [object java/lang/Object] )
  (move-result-object v4)
  (invoke-direct {v3 v4} java/lang/StringBuilder/<init> [object java/lang/String] )
  (const-string v4 ".bpg")
  (invoke-virtual {v3 v4} java/lang/StringBuilder/append [object java/lang/String] )
  (move-result-object v3)
  (invoke-virtual {v3} java/lang/StringBuilder/toString )
  (move-result-object v3)
  (invoke-direct {v2 v3} java/io/FileOutputStream/<init> [object java/lang/String] )
  (label l19216e)
  (line 249)
  (aget-object v3 v9 v5)
  (aget-object v4 v9 v8)
  (invoke-virtual {v4} java/lang/String/toCharArray )
  (move-result-object v4)
  (invoke-static {v3 v1 v2 v4 v7} org/bouncycastle2/openpgp/examples/SignedFileProcessor/signFile [object java/lang/String] [object java/io/InputStream] [object java/io/OutputStream] [array char] boolean )
  (goto l19212a)
  (label l192186)
  (line 252)
  (aget-object v3 v9 v7)
  (const-string v4 "-v")
  (invoke-virtual {v3 v4} java/lang/String/equals [object java/lang/Object] )
  (move-result v3)
  (if-eqz v3 l1921be)
  (line 254)
  (new-instance v0 java/io/FileInputStream)
  (aget-object v3 v9 v5)
  (invoke-direct {v0 v3} java/io/FileInputStream/<init> [object java/lang/String] )
  (label l1921a8)
  (line 255)
  (new-instance v1 java/io/FileInputStream)
  (aget-object v3 v9 v6)
  (invoke-direct {v1 v3} java/io/FileInputStream/<init> [object java/lang/String] )
  (label l1921b6)
  (line 257)
  (invoke-static {v0 v1} org/bouncycastle2/openpgp/examples/SignedFileProcessor/verifyFile [object java/io/InputStream] [object java/io/InputStream] )
  (goto l19212a)
  (label l1921be)
  (line 261)
  (sget-object v3 java/lang/System.err [object java/io/PrintStream])
  (const-string v4 "usage: SignedFileProcessor -v|-s [-a] file keyfile [passPhrase]")
  (invoke-virtual {v3 v4} java/io/PrintStream/println [object java/lang/String] )
  (goto l19212a)
 )

(method (attrs private static ) readSecretKey([object java/io/InputStream] )[object org/bouncycastle2/openpgp/PGPSecretKey]
  (annotation systemVisibility [object dalvik/annotation/Throws]
    (value [array [object java/lang/String]] [object java/io/IOException]  [object org/bouncycastle2/openpgp/PGPException])
  )
  (limit registers 9)
  ; parameter[0] : v8 ([object java/io/InputStream])
  (line 69)
  (invoke-static {v8} org/bouncycastle2/openpgp/PGPUtil/getDecoderStream [object java/io/InputStream] )
  (move-result-object v8)
  (line 71)
  (new-instance v4 org/bouncycastle2/openpgp/PGPSecretKeyRingCollection)
  (invoke-direct {v4 v8} org/bouncycastle2/openpgp/PGPSecretKeyRingCollection/<init> [object java/io/InputStream] )
  (line 77)
  (const/4 v3 0)
  (line 82)
  (invoke-virtual {v4} org/bouncycastle2/openpgp/PGPSecretKeyRingCollection/getKeyRings )
  (move-result-object v5)
  (label l1921fc)
  (line 84)
  (if-nez v3 l19220c)
  (invoke-interface {v5} java/util/Iterator/hasNext )
  (move-result v6)
  (if-nez v6 l192220)
  (label l19220c)
  (line 100)
  (if-nez v3 l192260)
  (line 102)
  (new-instance v6 java/lang/IllegalArgumentException)
  (const-string v7 "Can't find signing key in key ring.")
  (invoke-direct {v6 v7} java/lang/IllegalArgumentException/<init> [object java/lang/String] )
  (throw v6)
  (label l192220)
  (line 86)
  (invoke-interface {v5} java/util/Iterator/next )
  (move-result-object v2)
  (check-cast v2 [object org/bouncycastle2/openpgp/PGPSecretKeyRing])
  (label l19222c)
  (line 87)
  (invoke-virtual {v2} org/bouncycastle2/openpgp/PGPSecretKeyRing/getSecretKeys )
  (move-result-object v1)
  (label l192234)
  (line 89)
  (if-nez v3 l1921fc)
  (invoke-interface {v1} java/util/Iterator/hasNext )
  (move-result v6)
  (if-eqz v6 l1921fc)
  (line 91)
  (invoke-interface {v1} java/util/Iterator/next )
  (move-result-object v0)
  (check-cast v0 [object org/bouncycastle2/openpgp/PGPSecretKey])
  (label l192250)
  (line 93)
  (invoke-virtual {v0} org/bouncycastle2/openpgp/PGPSecretKey/isSigningKey )
  (move-result v6)
  (if-eqz v6 l192234)
  (line 95)
  (move-object v3 v0)
  (goto l192234)
  (label l192260)
  (line 105)
  (return-object v3)
 )

(method (attrs private static ) signFile([object java/lang/String] [object java/io/InputStream] [object java/io/OutputStream] [array char] boolean )void
  (annotation systemVisibility [object dalvik/annotation/Throws]
    (value [array [object java/lang/String]] [object java/io/IOException]  [object java/security/NoSuchAlgorithmException]  [object java/security/NoSuchProviderException]  [object org/bouncycastle2/openpgp/PGPException]  [object java/security/SignatureException])
  )
  (limit registers 22)
  ; parameter[0] : v17 ([object java/lang/String])
  ; parameter[1] : v18 ([object java/io/InputStream])
  ; parameter[2] : v19 ([object java/io/OutputStream])
  ; parameter[3] : v20 ([array char])
  ; parameter[4] : v21 (boolean)
  (line 181)
  (if-eqz v21 l19228a)
  (line 183)
  (new-instance v9 org/bouncycastle2/bcpg/ArmoredOutputStream)
  (move-object/from16 v0 v19)
  (invoke-direct {v9 v0} org/bouncycastle2/bcpg/ArmoredOutputStream/<init> [object java/io/OutputStream] )
  (label l192286)
  (move-object/from16 v19 v9)
  (label l19228a)
  (line 186)
  (invoke-static/range {v18} org/bouncycastle2/openpgp/examples/SignedFileProcessor/readSecretKey [object java/io/InputStream] )
  (move-result-object v11)
  (line 187)
  (const-string v14 "BC2")
  (move-object/from16 v0 v20)
  (invoke-virtual {v11 v0 v14} org/bouncycastle2/openpgp/PGPSecretKey/extractPrivateKey [array char] [object java/lang/String] )
  (move-result-object v10)
  (line 188)
  (new-instance v12 org/bouncycastle2/openpgp/PGPSignatureGenerator)
  (invoke-virtual {v11} org/bouncycastle2/openpgp/PGPSecretKey/getPublicKey )
  (move-result-object v14)
  (invoke-virtual {v14} org/bouncycastle2/openpgp/PGPPublicKey/getAlgorithm )
  (move-result v14)
  (const/4 v15 2)
  (const-string v16 "BC2")
  (move-object/from16 v0 v16)
  (invoke-direct {v12 v14 v15 v0} org/bouncycastle2/openpgp/PGPSignatureGenerator/<init> int int [object java/lang/String] )
  (line 190)
  (const/4 v14 0)
  (invoke-virtual {v12 v14 v10} org/bouncycastle2/openpgp/PGPSignatureGenerator/initSign int [object org/bouncycastle2/openpgp/PGPPrivateKey] )
  (line 192)
  (invoke-virtual {v11} org/bouncycastle2/openpgp/PGPSecretKey/getPublicKey )
  (move-result-object v14)
  (invoke-virtual {v14} org/bouncycastle2/openpgp/PGPPublicKey/getUserIDs )
  (move-result-object v6)
  (line 193)
  (invoke-interface {v6} java/util/Iterator/hasNext )
  (move-result v14)
  (if-eqz v14 l192316)
  (line 195)
  (new-instance v13 org/bouncycastle2/openpgp/PGPSignatureSubpacketGenerator)
  (invoke-direct {v13} org/bouncycastle2/openpgp/PGPSignatureSubpacketGenerator/<init> )
  (label l1922f4)
  (line 197)
  (const/4 v15 0)
  (invoke-interface {v6} java/util/Iterator/next )
  (move-result-object v14)
  (check-cast v14 [object java/lang/String])
  (invoke-virtual {v13 v15 v14} org/bouncycastle2/openpgp/PGPSignatureSubpacketGenerator/setSignerUserID boolean [object java/lang/String] )
  (line 198)
  (invoke-virtual {v13} org/bouncycastle2/openpgp/PGPSignatureSubpacketGenerator/generate )
  (move-result-object v14)
  (invoke-virtual {v12 v14} org/bouncycastle2/openpgp/PGPSignatureGenerator/setHashedSubpackets [object org/bouncycastle2/openpgp/PGPSignatureSubpacketVector] )
  (label l192316)
  (line 201)
  (new-instance v2 org/bouncycastle2/openpgp/PGPCompressedDataGenerator)
  (line 202)
  (const/4 v14 2)
  (line 201)
  (invoke-direct {v2 v14} org/bouncycastle2/openpgp/PGPCompressedDataGenerator/<init> int )
  (line 204)
  (new-instance v1 org/bouncycastle2/bcpg/BCPGOutputStream)
  (move-object/from16 v0 v19)
  (invoke-virtual {v2 v0} org/bouncycastle2/openpgp/PGPCompressedDataGenerator/open [object java/io/OutputStream] )
  (move-result-object v14)
  (invoke-direct {v1 v14} org/bouncycastle2/bcpg/BCPGOutputStream/<init> [object java/io/OutputStream] )
  (line 206)
  (const/4 v14 0)
  (invoke-virtual {v12 v14} org/bouncycastle2/openpgp/PGPSignatureGenerator/generateOnePassVersion boolean )
  (move-result-object v14)
  (invoke-virtual {v14 v1} org/bouncycastle2/openpgp/PGPOnePassSignature/encode [object java/io/OutputStream] )
  (line 208)
  (new-instance v5 java/io/File)
  (move-object/from16 v0 v17)
  (invoke-direct {v5 v0} java/io/File/<init> [object java/lang/String] )
  (line 209)
  (new-instance v7 org/bouncycastle2/openpgp/PGPLiteralDataGenerator)
  (invoke-direct {v7} org/bouncycastle2/openpgp/PGPLiteralDataGenerator/<init> )
  (line 210)
  (const/16 v14 98)
  (invoke-virtual {v7 v1 v14 v5} org/bouncycastle2/openpgp/PGPLiteralDataGenerator/open [object java/io/OutputStream] char [object java/io/File] )
  (move-result-object v8)
  (line 211)
  (new-instance v4 java/io/FileInputStream)
  (invoke-direct {v4 v5} java/io/FileInputStream/<init> [object java/io/File] )
  (line 212)
  (const/4 v3 0)
  (label l192378)
  (line 214)
  (invoke-virtual {v4} java/io/FileInputStream/read )
  (move-result v3)
  (if-gez v3 l1923a6)
  (line 220)
  (invoke-virtual {v7} org/bouncycastle2/openpgp/PGPLiteralDataGenerator/close )
  (line 222)
  (invoke-virtual {v12} org/bouncycastle2/openpgp/PGPSignatureGenerator/generate )
  (move-result-object v14)
  (invoke-virtual {v14 v1} org/bouncycastle2/openpgp/PGPSignature/encode [object java/io/OutputStream] )
  (line 224)
  (invoke-virtual {v2} org/bouncycastle2/openpgp/PGPCompressedDataGenerator/close )
  (line 226)
  (invoke-virtual/range {v19} java/io/OutputStream/close )
  (line 227)
  (return-void )
  (label l1923a6)
  (line 216)
  (invoke-virtual {v8 v3} java/io/OutputStream/write int )
  (line 217)
  (int-to-byte v14 v3)
  (invoke-virtual {v12 v14} org/bouncycastle2/openpgp/PGPSignatureGenerator/update byte )
  (goto l192378)
 )

(method (attrs private static ) verifyFile([object java/io/InputStream] [object java/io/InputStream] )void
  (annotation systemVisibility [object dalvik/annotation/Throws]
    (value [array [object java/lang/String]] [object java/lang/Exception])
  )
  (limit registers 16)
  ; parameter[0] : v14 ([object java/io/InputStream])
  ; parameter[1] : v15 ([object java/io/InputStream])
  (const/4 v13 0)
  (line 116)
  (invoke-static {v14} org/bouncycastle2/openpgp/PGPUtil/getDecoderStream [object java/io/InputStream] )
  (move-result-object v14)
  (line 118)
  (new-instance v9 org/bouncycastle2/openpgp/PGPObjectFactory)
  (invoke-direct {v9 v14} org/bouncycastle2/openpgp/PGPObjectFactory/<init> [object java/io/InputStream] )
  (label l1923dc)
  (line 120)
  (invoke-virtual {v9} org/bouncycastle2/openpgp/PGPObjectFactory/nextObject )
  (move-result-object v0)
  (check-cast v0 [object org/bouncycastle2/openpgp/PGPCompressedData])
  (line 122)
  (new-instance v9 org/bouncycastle2/openpgp/PGPObjectFactory)
  (label l1923ec)
  (invoke-virtual {v0} org/bouncycastle2/openpgp/PGPCompressedData/getDataStream )
  (move-result-object v11)
  (invoke-direct {v9 v11} org/bouncycastle2/openpgp/PGPObjectFactory/<init> [object java/io/InputStream] )
  (line 124)
  (invoke-virtual {v9} org/bouncycastle2/openpgp/PGPObjectFactory/nextObject )
  (move-result-object v6)
  (check-cast v6 [object org/bouncycastle2/openpgp/PGPOnePassSignatureList])
  (line 126)
  (invoke-virtual {v6 v13} org/bouncycastle2/openpgp/PGPOnePassSignatureList/get int )
  (move-result-object v4)
  (line 128)
  (invoke-virtual {v9} org/bouncycastle2/openpgp/PGPObjectFactory/nextObject )
  (move-result-object v7)
  (check-cast v7 [object org/bouncycastle2/openpgp/PGPLiteralData])
  (line 130)
  (invoke-virtual {v7} org/bouncycastle2/openpgp/PGPLiteralData/getInputStream )
  (move-result-object v2)
  (line 132)
  (new-instance v10 org/bouncycastle2/openpgp/PGPPublicKeyRingCollection)
  (invoke-static {v15} org/bouncycastle2/openpgp/PGPUtil/getDecoderStream [object java/io/InputStream] )
  (move-result-object v11)
  (invoke-direct {v10 v11} org/bouncycastle2/openpgp/PGPPublicKeyRingCollection/<init> [object java/io/InputStream] )
  (line 134)
  (invoke-virtual {v4} org/bouncycastle2/openpgp/PGPOnePassSignature/getKeyID )
  (move-result-wide v11)
  (invoke-virtual {v10 v11 v12} org/bouncycastle2/openpgp/PGPPublicKeyRingCollection/getPublicKey long )
  (move-result-object v3)
  (line 135)
  (new-instance v5 java/io/FileOutputStream)
  (invoke-virtual {v7} org/bouncycastle2/openpgp/PGPLiteralData/getFileName )
  (move-result-object v11)
  (invoke-direct {v5 v11} java/io/FileOutputStream/<init> [object java/lang/String] )
  (line 137)
  (const-string v11 "BC2")
  (invoke-virtual {v4 v3 v11} org/bouncycastle2/openpgp/PGPOnePassSignature/initVerify [object org/bouncycastle2/openpgp/PGPPublicKey] [object java/lang/String] )
  (label l192460)
  (line 139)
  (invoke-virtual {v2} java/io/InputStream/read )
  (move-result v1)
  (if-gez v1 l1924a2)
  (line 145)
  (invoke-virtual {v5} java/io/FileOutputStream/close )
  (line 147)
  (invoke-virtual {v9} org/bouncycastle2/openpgp/PGPObjectFactory/nextObject )
  (move-result-object v8)
  (check-cast v8 [object org/bouncycastle2/openpgp/PGPSignatureList])
  (label l19247e)
  (line 149)
  (invoke-virtual {v8 v13} org/bouncycastle2/openpgp/PGPSignatureList/get int )
  (move-result-object v11)
  (invoke-virtual {v4 v11} org/bouncycastle2/openpgp/PGPOnePassSignature/verify [object org/bouncycastle2/openpgp/PGPSignature] )
  (move-result v11)
  (if-eqz v11 l1924b2)
  (line 151)
  (sget-object v11 java/lang/System.out [object java/io/PrintStream])
  (const-string v12 "signature verified.")
  (invoke-virtual {v11 v12} java/io/PrintStream/println [object java/lang/String] )
  (label l1924a0)
  (line 157)
  (return-void )
  (label l1924a2)
  (line 141)
  (int-to-byte v11 v1)
  (invoke-virtual {v4 v11} org/bouncycastle2/openpgp/PGPOnePassSignature/update byte )
  (line 142)
  (invoke-virtual {v5 v1} java/io/FileOutputStream/write int )
  (goto l192460)
  (label l1924b2)
  (line 155)
  (sget-object v11 java/lang/System.out [object java/io/PrintStream])
  (const-string v12 "signature verification failed.")
  (invoke-virtual {v11 v12} java/io/PrintStream/println [object java/lang/String] )
  (goto l1924a0)
 )

)
