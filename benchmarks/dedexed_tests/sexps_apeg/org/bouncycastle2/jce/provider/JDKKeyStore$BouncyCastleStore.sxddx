(class (attrs public ) org/bouncycastle2/jce/provider/JDKKeyStore$BouncyCastleStore
 (super org/bouncycastle2/jce/provider/JDKKeyStore)
 (source "JDKKeyStore.java")


(method (attrs public ) <init>()void
  (limit registers 1)
  ; this: v0 ([object org/bouncycastle2/jce/provider/JDKKeyStore$BouncyCastleStore])
  (line 904)
  (invoke-direct {v0} org/bouncycastle2/jce/provider/JDKKeyStore/<init> )
  (return-void )
 )

(method (attrs public ) engineLoad([object java/io/InputStream] [array char] )void
  (annotation systemVisibility [object dalvik/annotation/Throws]
    (value [array [object java/lang/String]] [object java/io/IOException])
  )
  (limit registers 17)
  ; this: v14 ([object org/bouncycastle2/jce/provider/JDKKeyStore$BouncyCastleStore])
  ; parameter[0] : v15 ([object java/io/InputStream])
  ; parameter[1] : v16 ([array char])
  (line 912)
  (iget-object v0 v14 org/bouncycastle2/jce/provider/JDKKeyStore$BouncyCastleStore.table [object java/util/Hashtable])
  (invoke-virtual {v0} java/util/Hashtable/clear )
  (line 914)
  (if-nez v15 l1423dc)
  (label l1423da)
  (line 978)
  (return-void )
  (label l1423dc)
  (line 919)
  (new-instance v8 java/io/DataInputStream)
  (invoke-direct {v8 v15} java/io/DataInputStream/<init> [object java/io/InputStream] )
  (line 920)
  (invoke-virtual {v8} java/io/DataInputStream/readInt )
  (move-result v13)
  (line 922)
  (const/4 v0 1)
  (if-eq v13 v0 l142408)
  (line 924)
  (if-eqz v13 l142408)
  (line 926)
  (new-instance v0 java/io/IOException)
  (const-string v2 "Wrong version of key store.")
  (invoke-direct {v0 v2} java/io/IOException/<init> [object java/lang/String] )
  (throw v0)
  (label l142408)
  (line 930)
  (invoke-virtual {v8} java/io/DataInputStream/readInt )
  (move-result v0)
  (new-array v4 v0 [array byte])
  (line 932)
  (array-length v0 v4)
  (const/16 v2 20)
  (if-eq v0 v2 l14242e)
  (line 934)
  (new-instance v0 java/io/IOException)
  (const-string v2 "Key store corrupted.")
  (invoke-direct {v0 v2} java/io/IOException/<init> [object java/lang/String] )
  (throw v0)
  (label l14242e)
  (line 937)
  (invoke-virtual {v8 v4} java/io/DataInputStream/readFully [array byte] )
  (line 939)
  (invoke-virtual {v8} java/io/DataInputStream/readInt )
  (move-result v5)
  (line 941)
  (if-ltz v5 l142448)
  (const/16 v0 4096)
  (if-le v5 v0 l142458)
  (label l142448)
  (line 943)
  (new-instance v0 java/io/IOException)
  (const-string v2 "Key store corrupted.")
  (invoke-direct {v0 v2} java/io/IOException/<init> [object java/lang/String] )
  (throw v0)
  (label l142458)
  (line 947)
  (if-nez v13 l1424e0)
  (line 949)
  (const-string v1 "OldPBEWithSHAAndTwofish-CBC")
  (label l142460)
  (line 956)
  (const/4 v2 2)
  (move-object v0 v14)
  (move-object/from16 v3 v16)
  (invoke-virtual/range {v0 .. v5} org/bouncycastle2/jce/provider/JDKKeyStore$BouncyCastleStore/makePBECipher [object java/lang/String] int [array char] [array byte] int )
  (move-result-object v7)
  (label l142470)
  (line 957)
  (new-instance v6 javax/crypto/CipherInputStream)
  (invoke-direct {v6 v8 v7} javax/crypto/CipherInputStream/<init> [object java/io/InputStream] [object javax/crypto/Cipher] )
  (label l14247a)
  (line 959)
  (new-instance v10 org/bouncycastle2/crypto/digests/SHA1Digest)
  (invoke-direct {v10} org/bouncycastle2/crypto/digests/SHA1Digest/<init> )
  (label l142484)
  (line 960)
  (new-instance v9 org/bouncycastle2/crypto/io/DigestInputStream)
  (invoke-direct {v9 v6 v10} org/bouncycastle2/crypto/io/DigestInputStream/<init> [object java/io/InputStream] [object org/bouncycastle2/crypto/Digest] )
  (label l14248e)
  (line 962)
  (invoke-virtual {v14 v9} org/bouncycastle2/jce/provider/JDKKeyStore$BouncyCastleStore/loadStore [object java/io/InputStream] )
  (line 965)
  (invoke-interface {v10} org/bouncycastle2/crypto/Digest/getDigestSize )
  (move-result v0)
  (new-array v11 v0 [array byte])
  (label l1424a0)
  (line 966)
  (const/4 v0 0)
  (invoke-interface {v10 v11 v0} org/bouncycastle2/crypto/Digest/doFinal [array byte] int )
  (line 970)
  (invoke-interface {v10} org/bouncycastle2/crypto/Digest/getDigestSize )
  (move-result v0)
  (new-array v12 v0 [array byte])
  (label l1424b4)
  (line 971)
  (invoke-static {v6 v12} org/bouncycastle2/util/io/Streams/readFully [object java/io/InputStream] [array byte] )
  (line 973)
  (invoke-static {v11 v12} org/bouncycastle2/util/Arrays/constantTimeAreEqual [array byte] [array byte] )
  (move-result v0)
  (if-nez v0 l1423da)
  (line 975)
  (iget-object v0 v14 org/bouncycastle2/jce/provider/JDKKeyStore$BouncyCastleStore.table [object java/util/Hashtable])
  (invoke-virtual {v0} java/util/Hashtable/clear )
  (line 976)
  (new-instance v0 java/io/IOException)
  (const-string v2 "KeyStore integrity check failed.")
  (invoke-direct {v0 v2} java/io/IOException/<init> [object java/lang/String] )
  (throw v0)
  (label l1424e0)
  (line 953)
  (const-string v1 "PBEWithSHAAndTwofish-CBC")
  (goto l142460)
)

(method (attrs public ) engineStore([object java/io/OutputStream] [array char] )void
  (annotation systemVisibility [object dalvik/annotation/Throws]
    (value [array [object java/lang/String]] [object java/io/IOException])
  )
  (limit registers 15)
  ; this: v12 ([object org/bouncycastle2/jce/provider/JDKKeyStore$BouncyCastleStore])
  ; parameter[0] : v13 ([object java/io/OutputStream])
  ; parameter[1] : v14 ([array char])
  (const/4 v2 1)
  (line 985)
  (new-instance v8 java/io/DataOutputStream)
  (invoke-direct {v8 v13} java/io/DataOutputStream/<init> [object java/io/OutputStream] )
  (line 986)
  (const/16 v0 20)
  (new-array v4 v0 [array byte])
  (line 987)
  (iget-object v0 v12 org/bouncycastle2/jce/provider/JDKKeyStore$BouncyCastleStore.random [object java/security/SecureRandom])
  (invoke-virtual {v0} java/security/SecureRandom/nextInt )
  (move-result v0)
  (and-int/lit16 v0 v0 1023)
  (add-int/lit16 v5 v0 1024)
  (line 989)
  (iget-object v0 v12 org/bouncycastle2/jce/provider/JDKKeyStore$BouncyCastleStore.random [object java/security/SecureRandom])
  (invoke-virtual {v0 v4} java/security/SecureRandom/nextBytes [array byte] )
  (line 991)
  (invoke-virtual {v8 v2} java/io/DataOutputStream/writeInt int )
  (line 992)
  (array-length v0 v4)
  (invoke-virtual {v8 v0} java/io/DataOutputStream/writeInt int )
  (line 993)
  (invoke-virtual {v8 v4} java/io/DataOutputStream/write [array byte] )
  (line 994)
  (invoke-virtual {v8 v5} java/io/DataOutputStream/writeInt int )
  (line 996)
  (const-string v1 "PBEWithSHAAndTwofish-CBC")
  (move-object v0 v12)
  (move-object v3 v14)
  (invoke-virtual/range {v0 .. v5} org/bouncycastle2/jce/provider/JDKKeyStore$BouncyCastleStore/makePBECipher [object java/lang/String] int [array char] [array byte] int )
  (move-result-object v7)
  (line 998)
  (new-instance v6 javax/crypto/CipherOutputStream)
  (invoke-direct {v6 v8 v7} javax/crypto/CipherOutputStream/<init> [object java/io/OutputStream] [object javax/crypto/Cipher] )
  (line 999)
  (new-instance v9 org/bouncycastle2/crypto/io/DigestOutputStream)
  (new-instance v0 org/bouncycastle2/crypto/digests/SHA1Digest)
  (invoke-direct {v0} org/bouncycastle2/crypto/digests/SHA1Digest/<init> )
  (invoke-direct {v9 v6 v0} org/bouncycastle2/crypto/io/DigestOutputStream/<init> [object java/io/OutputStream] [object org/bouncycastle2/crypto/Digest] )
  (line 1001)
  (invoke-virtual {v12 v9} org/bouncycastle2/jce/provider/JDKKeyStore$BouncyCastleStore/saveStore [object java/io/OutputStream] )
  (line 1003)
  (invoke-virtual {v9} org/bouncycastle2/crypto/io/DigestOutputStream/getDigest )
  (move-result-object v10)
  (line 1004)
  (invoke-interface {v10} org/bouncycastle2/crypto/Digest/getDigestSize )
  (move-result v0)
  (new-array v11 v0 [array byte])
  (line 1006)
  (const/4 v0 0)
  (invoke-interface {v10 v11 v0} org/bouncycastle2/crypto/Digest/doFinal [array byte] int )
  (line 1008)
  (invoke-virtual {v6 v11} javax/crypto/CipherOutputStream/write [array byte] )
  (line 1010)
  (invoke-virtual {v6} javax/crypto/CipherOutputStream/close )
  (line 1011)
  (return-void )
)

)
