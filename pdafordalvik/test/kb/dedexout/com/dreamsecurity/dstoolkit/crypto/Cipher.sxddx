(class (attrs public ) com/dreamsecurity/dstoolkit/crypto/Cipher
 (super java/lang/Object)
 (source "Cipher.java")

 (field (attrs public static final ) DECRYPT_MODE int 2); 0x2 )
 (field (attrs public static final ) ENCRYPT_MODE int 1); 0x1 )
 (field (attrs private static final ) PAD_NONE int 3); 0x3 )
 (field (attrs private static final ) PAD_PKCS5 int 1); 0x1 )
 (field (attrs private static final ) PAD_SSL int 2); 0x2 )
 (field (attrs ) algCode int )
 (field (attrs private ) errBuff [array byte] )
 (field (attrs ) hashAlg int )
 (field (attrs ) isRSAV20 boolean )
 (field (attrs private ) ivBuff [array byte] )
 (field (attrs private ) keyBuff [array byte] )
 (field (attrs ) keySpec [object com/dreamsecurity/dstoolkit/crypto/Key] )
 (field (attrs ) mode int )
 (field (attrs private ) outBuff [array byte] )
 (field (attrs ) padType int )

(method (attrs protected ) <init>()void
  (limit registers 2)
  ; this: v1 ([object com/dreamsecurity/dstoolkit/crypto/Cipher])
  (line 52)
  (invoke-direct {v1} java/lang/Object/<init> )
  (line 53)
  (const/4 v0 0)
  (iput-boolean v0 v1 com/dreamsecurity/dstoolkit/crypto/Cipher.isRSAV20 boolean)
  (line 54)
  (return-void )
 )

(method (attrs private native ) _decrypt(int [array byte] [array byte] [array byte] boolean int )int
 )

(method (attrs private native ) _decrypt([array byte] [array byte] boolean boolean int )int
 )

(method (attrs private native ) _encrypt(int [array byte] [array byte] [array byte] boolean int )int
 )

(method (attrs private native ) _encrypt([array byte] [array byte] boolean boolean int )int
 )

(method (attrs private ) errBuff2String()[object java/lang/String]
  (limit registers 5)
  ; this: v4 ([object com/dreamsecurity/dstoolkit/crypto/Cipher])
  (catch java/io/UnsupportedEncodingException from l4f420 to l4f432 using l4f434)
  (label l4f420)
  (line 285)
  (new-instance v1 java/lang/String)
  (iget-object v2 v4 com/dreamsecurity/dstoolkit/crypto/Cipher.errBuff [array byte])
  (const-string v3 "KSC5601")
  (invoke-direct {v1 v2 v3} java/lang/String/<init> [array byte] [object java/lang/String] )
  (label l4f432)
  (line 288)
  (return-object v1)
  (label l4f434)
  (line 287)
  (move-exception v1)
  (move-object v0 v1)
  (line 288)
  (new-instance v1 java/lang/String)
  (iget-object v2 v4 com/dreamsecurity/dstoolkit/crypto/Cipher.errBuff [array byte])
  (invoke-direct {v1 v2} java/lang/String/<init> [array byte] )
  (goto l4f432)
 )

(method (attrs public static final ) getInstance([object java/lang/String] )[object com/dreamsecurity/dstoolkit/crypto/Cipher]
  (annotation systemVisibility [object dalvik/annotation/Throws]
    (value [array [object java/lang/String]] [object com/dreamsecurity/dstoolkit/exception/DSToolkitException])
  )
  (limit registers 10)
  ; parameter[0] : v9 ([object java/lang/String])
  (const/4 v7 1)
  (const-string v8 "RSAV20")
  (line 123)
  (if-eqz v9 l4f47e)
  (invoke-virtual {v9} java/lang/String/length )
  (move-result v6)
  (if-nez v6 l4f48e)
  (label l4f47e)
  (line 124)
  (new-instance v6 com/dreamsecurity/dstoolkit/exception/DSToolkitException)
  (const-string v7 "The algorithm is empty. You must input a value for it.")
  (invoke-direct {v6 v7} com/dreamsecurity/dstoolkit/exception/DSToolkitException/<init> [object java/lang/String] )
  (throw v6)
  (label l4f48e)
  (line 126)
  (new-instance v2 com/dreamsecurity/dstoolkit/crypto/Cipher)
  (invoke-direct {v2} com/dreamsecurity/dstoolkit/crypto/Cipher/<init> )
  (line 127)
  (const-string v0 "")
  (line 129)
  (invoke-virtual {v9} java/lang/String/length )
  (move-result v5)
  (line 130)
  (const-string v6 "RSAV20")
  (invoke-virtual {v9 v8} java/lang/String/startsWith [object java/lang/String] )
  (move-result v6)
  (if-eqz v6 l4f54a)
  (line 132)
  (iput-boolean v7 v2 com/dreamsecurity/dstoolkit/crypto/Cipher.isRSAV20 boolean)
  (line 133)
  (invoke-virtual {v9} java/lang/String/length )
  (move-result v6)
  (const/4 v7 6)
  (if-le v6 v7 l4f538)
  (line 134)
  (const-string v6 "RSAV20")
  (invoke-virtual {v8} java/lang/String/length )
  (move-result v6)
  (add-int/lit8 v6 v6 1)
  (invoke-virtual {v9 v6} java/lang/String/substring int )
  (move-result-object v6)
  (invoke-static {v6} com/dreamsecurity/dstoolkit/crypto/Algorithm/getHashAlg [object java/lang/String] )
  (move-result v6)
  (iput v6 v2 com/dreamsecurity/dstoolkit/crypto/Cipher.hashAlg int)
  (label l4f4ea)
  (line 140)
  (const-string v0 "RSAV20")
  (label l4f4ee)
  (line 179)
  (invoke-static {v0} com/dreamsecurity/dstoolkit/crypto/Algorithm/getCipherAlg [object java/lang/String] )
  (move-result v6)
  (iput v6 v2 com/dreamsecurity/dstoolkit/crypto/Cipher.algCode int)
  (line 180)
  (iget v6 v2 com/dreamsecurity/dstoolkit/crypto/Cipher.algCode int)
  (if-nez v6 l4f5aa)
  (line 181)
  (new-instance v6 com/dreamsecurity/dstoolkit/exception/DSToolkitException)
  (new-instance v7 java/lang/StringBuilder)
  (const-string v8 "Unknown algorithm. (input :")
  (invoke-direct {v7 v8} java/lang/StringBuilder/<init> [object java/lang/String] )
  (invoke-virtual {v7 v9} java/lang/StringBuilder/append [object java/lang/String] )
  (move-result-object v7)
  (const-string v8 ")")
  (invoke-virtual {v7 v8} java/lang/StringBuilder/append [object java/lang/String] )
  (move-result-object v7)
  (invoke-virtual {v7} java/lang/StringBuilder/toString )
  (move-result-object v7)
  (invoke-direct {v6 v7} com/dreamsecurity/dstoolkit/exception/DSToolkitException/<init> [object java/lang/String] )
  (throw v6)
  (label l4f538)
  (line 137)
  (const-string v6 "SHA1")
  (invoke-static {v6} com/dreamsecurity/dstoolkit/crypto/Algorithm/getHashAlg [object java/lang/String] )
  (move-result v6)
  (iput v6 v2 com/dreamsecurity/dstoolkit/crypto/Cipher.hashAlg int)
  (goto l4f4ea)
  (label l4f54a)
  (line 142)
  (const/4 v6 4)
  (if-lt v5 v6 l4f5a6)
  (line 144)
  (const/4 v4 0)
  (label l4f552)
  (line 145)
  (move v4 v5)
  (label l4f554)
  (if-gtz v4 l4f584)
  (label l4f558)
  (line 152)
  (invoke-virtual {v9 v4} java/lang/String/substring int )
  (move-result-object v1)
  (label l4f560)
  (line 159)
  (const-string v6 "PKCS5")
  (invoke-virtual {v1 v6} java/lang/String/equals [object java/lang/Object] )
  (move-result v6)
  (if-eqz v6 l4f59e)
  (line 161)
  (iput v7 v2 com/dreamsecurity/dstoolkit/crypto/Cipher.padType int)
  (line 162)
  (const/4 v6 0)
  (sub-int v7 v4 v7)
  (invoke-virtual {v9 v6 v7} java/lang/String/substring int int )
  (move-result-object v0)
  (goto l4f4ee)
  (label l4f584)
  (line 147)
  (sub-int v6 v4 v7)
  (invoke-virtual {v9 v6} java/lang/String/charAt int )
  (move-result v3)
  (label l4f590)
  (line 148)
  (const/16 v6 47)
  (if-eq v3 v6 l4f558)
  (line 145)
  (add-int/lit8 v4 v4 255)
  (goto l4f554)
  (label l4f59e)
  (line 171)
  (iput v7 v2 com/dreamsecurity/dstoolkit/crypto/Cipher.padType int)
  (line 172)
  (move-object v0 v9)
  (goto l4f4ee)
  (label l4f5a6)
  (line 176)
  (move-object v0 v9)
  (goto l4f4ee)
  (label l4f5aa)
  (line 183)
  (return-object v2)
 )

(method (attrs public final ) doFinal([array byte] )[array byte]
  (annotation systemVisibility [object dalvik/annotation/Throws]
    (value [array [object java/lang/String]] [object com/dreamsecurity/dstoolkit/exception/DSToolkitException])
  )
  (limit registers 11)
  ; this: v9 ([object com/dreamsecurity/dstoolkit/crypto/Cipher])
  ; parameter[0] : v10 ([array byte])
  (const/4 v3 1)
  (const/4 v5 0)
  (line 242)
  (if-nez v10 l4f5d4)
  (line 243)
  (new-instance v0 com/dreamsecurity/dstoolkit/exception/DSToolkitException)
  (const-string v1 "The input is null. You must input a value for it.")
  (invoke-direct {v0 v1} com/dreamsecurity/dstoolkit/exception/DSToolkitException/<init> [object java/lang/String] )
  (throw v0)
  (label l4f5d4)
  (line 245)
  (const/4 v8 0)
  (line 246)
  (iget v0 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.mode int)
  (if-ne v0 v3 l4f69a)
  (line 247)
  (iget-object v0 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.keySpec [object com/dreamsecurity/dstoolkit/crypto/Key])
  (instance-of v0 v0 com/dreamsecurity/dstoolkit/crypto/SecretKey)
  (if-eqz v0 l4f63a)
  (line 248)
  (iget v0 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.algCode int)
  (invoke-static {v0} com/dreamsecurity/dstoolkit/crypto/Algorithm/code2id int )
  (move-result v1)
  (iget-object v0 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.keySpec [object com/dreamsecurity/dstoolkit/crypto/Key])
  (invoke-interface {v0} com/dreamsecurity/dstoolkit/crypto/Key/getKey )
  (move-result-object v2)
  (iget-object v0 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.keySpec [object com/dreamsecurity/dstoolkit/crypto/Key])
  (check-cast v0 [object com/dreamsecurity/dstoolkit/crypto/SecretKey])
  (invoke-virtual {v0} com/dreamsecurity/dstoolkit/crypto/SecretKey/getIv )
  (move-result-object v3)
  (iget v6 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.padType int)
  (move-object v0 v9)
  (move-object v4 v10)
  (invoke-direct/range {v0 .. v6} com/dreamsecurity/dstoolkit/crypto/Cipher/_encrypt int [array byte] [array byte] [array byte] boolean int )
  (move-result v8)
  (label l4f622)
  (line 269)
  (if-lez v8 l4f74c)
  (line 270)
  (new-instance v0 com/dreamsecurity/dstoolkit/exception/DSToolkitException)
  (invoke-direct {v9} com/dreamsecurity/dstoolkit/crypto/Cipher/errBuff2String )
  (move-result-object v1)
  (invoke-direct {v0 v1} com/dreamsecurity/dstoolkit/exception/DSToolkitException/<init> [object java/lang/String] )
  (throw v0)
  (label l4f63a)
  (line 251)
  (iget-object v0 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.keySpec [object com/dreamsecurity/dstoolkit/crypto/Key])
  (instance-of v0 v0 com/dreamsecurity/dstoolkit/crypto/PrivateKey)
  (if-eqz v0 l4f670)
  (line 252)
  (iget-object v0 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.keySpec [object com/dreamsecurity/dstoolkit/crypto/Key])
  (invoke-interface {v0} com/dreamsecurity/dstoolkit/crypto/Key/getKey )
  (move-result-object v1)
  (iget-boolean v4 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.isRSAV20 boolean)
  (iget v0 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.hashAlg int)
  (invoke-static {v0} com/dreamsecurity/dstoolkit/crypto/Algorithm/code2id int )
  (move-result v5)
  (move-object v0 v9)
  (move-object v2 v10)
  (invoke-direct/range {v0 .. v5} com/dreamsecurity/dstoolkit/crypto/Cipher/_encrypt [array byte] [array byte] boolean boolean int )
  (move-result v8)
  (goto l4f622)
  (label l4f670)
  (line 254)
  (iget-object v0 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.keySpec [object com/dreamsecurity/dstoolkit/crypto/Key])
  (invoke-interface {v0} com/dreamsecurity/dstoolkit/crypto/Key/getKey )
  (move-result-object v3)
  (iget-boolean v6 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.isRSAV20 boolean)
  (iget v0 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.hashAlg int)
  (invoke-static {v0} com/dreamsecurity/dstoolkit/crypto/Algorithm/code2id int )
  (move-result v7)
  (move-object v2 v9)
  (move-object v4 v10)
  (invoke-direct/range {v2 .. v7} com/dreamsecurity/dstoolkit/crypto/Cipher/_encrypt [array byte] [array byte] boolean boolean int )
  (move-result v8)
  (goto l4f622)
  (label l4f69a)
  (line 257)
  (iget v0 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.mode int)
  (const/4 v1 2)
  (if-ne v0 v1 l4f622)
  (line 258)
  (iget-object v0 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.keySpec [object com/dreamsecurity/dstoolkit/crypto/Key])
  (instance-of v0 v0 com/dreamsecurity/dstoolkit/crypto/SecretKey)
  (if-eqz v0 l4f6ea)
  (line 259)
  (iget v0 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.algCode int)
  (invoke-static {v0} com/dreamsecurity/dstoolkit/crypto/Algorithm/code2id int )
  (move-result v1)
  (iget-object v0 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.keySpec [object com/dreamsecurity/dstoolkit/crypto/Key])
  (invoke-interface {v0} com/dreamsecurity/dstoolkit/crypto/Key/getKey )
  (move-result-object v2)
  (iget-object v0 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.keySpec [object com/dreamsecurity/dstoolkit/crypto/Key])
  (check-cast v0 [object com/dreamsecurity/dstoolkit/crypto/SecretKey])
  (invoke-virtual {v0} com/dreamsecurity/dstoolkit/crypto/SecretKey/getIv )
  (move-result-object v3)
  (iget v6 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.padType int)
  (move-object v0 v9)
  (move-object v4 v10)
  (invoke-direct/range {v0 .. v6} com/dreamsecurity/dstoolkit/crypto/Cipher/_decrypt int [array byte] [array byte] [array byte] boolean int )
  (move-result v8)
  (goto l4f622)
  (label l4f6ea)
  (line 262)
  (iget-object v0 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.keySpec [object com/dreamsecurity/dstoolkit/crypto/Key])
  (instance-of v0 v0 com/dreamsecurity/dstoolkit/crypto/PrivateKey)
  (if-eqz v0 l4f720)
  (line 263)
  (iget-object v0 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.keySpec [object com/dreamsecurity/dstoolkit/crypto/Key])
  (invoke-interface {v0} com/dreamsecurity/dstoolkit/crypto/Key/getKey )
  (move-result-object v1)
  (iget-boolean v4 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.isRSAV20 boolean)
  (iget v0 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.hashAlg int)
  (invoke-static {v0} com/dreamsecurity/dstoolkit/crypto/Algorithm/code2id int )
  (move-result v5)
  (move-object v0 v9)
  (move-object v2 v10)
  (invoke-direct/range {v0 .. v5} com/dreamsecurity/dstoolkit/crypto/Cipher/_decrypt [array byte] [array byte] boolean boolean int )
  (move-result v8)
  (goto l4f622)
  (label l4f720)
  (line 265)
  (iget-object v0 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.keySpec [object com/dreamsecurity/dstoolkit/crypto/Key])
  (invoke-interface {v0} com/dreamsecurity/dstoolkit/crypto/Key/getKey )
  (move-result-object v3)
  (iget-boolean v6 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.isRSAV20 boolean)
  (iget v0 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.hashAlg int)
  (invoke-static {v0} com/dreamsecurity/dstoolkit/crypto/Algorithm/code2id int )
  (move-result v7)
  (move-object v2 v9)
  (move-object v4 v10)
  (invoke-direct/range {v2 .. v7} com/dreamsecurity/dstoolkit/crypto/Cipher/_decrypt [array byte] [array byte] boolean boolean int )
  (move-result v8)
  (goto/16 l4f622)
  (label l4f74c)
  (line 273)
  (iget-object v0 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.keySpec [object com/dreamsecurity/dstoolkit/crypto/Key])
  (instance-of v0 v0 com/dreamsecurity/dstoolkit/crypto/SecretKey)
  (if-eqz v0 l4f772)
  (line 274)
  (if-nez v8 l4f772)
  (line 275)
  (iget-object v0 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.keySpec [object com/dreamsecurity/dstoolkit/crypto/Key])
  (check-cast v0 [object com/dreamsecurity/dstoolkit/crypto/SecretKey])
  (iget-object v1 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.keyBuff [array byte])
  (iget-object v2 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.ivBuff [array byte])
  (invoke-virtual {v0 v1 v2} com/dreamsecurity/dstoolkit/crypto/SecretKey/setChangedKeyAndIV [array byte] [array byte] )
  (label l4f772)
  (line 278)
  (iget-object v0 v9 com/dreamsecurity/dstoolkit/crypto/Cipher.outBuff [array byte])
  (return-object v0)
)

(method (attrs public final ) init(int [object com/dreamsecurity/dstoolkit/crypto/Key] )void
  (annotation systemVisibility [object dalvik/annotation/Throws]
    (value [array [object java/lang/String]] [object com/dreamsecurity/dstoolkit/exception/DSToolkitException])
  )
  (limit registers 6)
  ; this: v3 ([object com/dreamsecurity/dstoolkit/crypto/Cipher])
  ; parameter[0] : v4 (int)
  ; parameter[1] : v5 ([object com/dreamsecurity/dstoolkit/crypto/Key])
  (line 202)
  (if-nez v5 l4f79c)
  (line 203)
  (new-instance v1 com/dreamsecurity/dstoolkit/exception/DSToolkitException)
  (const-string v2 "The key is empty. You must input a value for it.")
  (invoke-direct {v1 v2} com/dreamsecurity/dstoolkit/exception/DSToolkitException/<init> [object java/lang/String] )
  (throw v1)
  (label l4f79c)
  (line 205)
  (const/4 v1 1)
  (if-eq v4 v1 l4f7b8)
  (const/4 v1 2)
  (if-eq v4 v1 l4f7b8)
  (line 206)
  (new-instance v1 com/dreamsecurity/dstoolkit/exception/DSToolkitException)
  (const-string v2 "The given opmode is unknown mode.")
  (invoke-direct {v1 v2} com/dreamsecurity/dstoolkit/exception/DSToolkitException/<init> [object java/lang/String] )
  (throw v1)
  (label l4f7b8)
  (line 208)
  (iput v4 v3 com/dreamsecurity/dstoolkit/crypto/Cipher.mode int)
  (line 210)
  (invoke-interface {v5} com/dreamsecurity/dstoolkit/crypto/Key/getKeyAlg )
  (move-result-object v1)
  (iget v2 v3 com/dreamsecurity/dstoolkit/crypto/Cipher.algCode int)
  (invoke-static {v1 v2} com/dreamsecurity/dstoolkit/crypto/Algorithm/isSame [object java/lang/String] int )
  (move-result v1)
  (if-nez v1 l4f7e4)
  (line 211)
  (new-instance v1 com/dreamsecurity/dstoolkit/exception/DSToolkitException)
  (const-string v2 "The given key is inappropriate for initializing this cipher")
  (invoke-direct {v1 v2} com/dreamsecurity/dstoolkit/exception/DSToolkitException/<init> [object java/lang/String] )
  (throw v1)
  (label l4f7e4)
  (line 213)
  (invoke-interface {v5} com/dreamsecurity/dstoolkit/crypto/Key/getKey )
  (move-result-object v1)
  (if-eqz v1 l4f7fe)
  (invoke-interface {v5} com/dreamsecurity/dstoolkit/crypto/Key/getKey )
  (move-result-object v1)
  (array-length v1 v1)
  (if-nez v1 l4f80e)
  (label l4f7fe)
  (line 214)
  (new-instance v1 com/dreamsecurity/dstoolkit/exception/DSToolkitException)
  (const-string v2 "The key is empty.")
  (invoke-direct {v1 v2} com/dreamsecurity/dstoolkit/exception/DSToolkitException/<init> [object java/lang/String] )
  (throw v1)
  (label l4f80e)
  (line 216)
  (instance-of v1 v5 com/dreamsecurity/dstoolkit/crypto/SecretKey)
  (if-eqz v1 l4f850)
  (line 218)
  (move-object v0 v5)
  (check-cast v0 [object com/dreamsecurity/dstoolkit/crypto/SecretKey])
  (move-object v1 v0)
  (invoke-virtual {v1} com/dreamsecurity/dstoolkit/crypto/SecretKey/getIv )
  (move-result-object v1)
  (if-eqz v1 l4f840)
  (move-object v0 v5)
  (check-cast v0 [object com/dreamsecurity/dstoolkit/crypto/SecretKey])
  (move-object v1 v0)
  (invoke-virtual {v1} com/dreamsecurity/dstoolkit/crypto/SecretKey/getIv )
  (move-result-object v1)
  (array-length v1 v1)
  (if-nez v1 l4f850)
  (label l4f840)
  (line 219)
  (new-instance v1 com/dreamsecurity/dstoolkit/exception/DSToolkitException)
  (const-string v2 "The iv is empty.")
  (invoke-direct {v1 v2} com/dreamsecurity/dstoolkit/exception/DSToolkitException/<init> [object java/lang/String] )
  (throw v1)
  (label l4f850)
  (line 222)
  (iput-object v5 v3 com/dreamsecurity/dstoolkit/crypto/Cipher.keySpec [object com/dreamsecurity/dstoolkit/crypto/Key])
  (line 223)
  (return-void )
)

)
