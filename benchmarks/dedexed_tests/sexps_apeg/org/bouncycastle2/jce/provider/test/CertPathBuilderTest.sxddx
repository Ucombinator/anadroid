(class (attrs public ) org/bouncycastle2/jce/provider/test/CertPathBuilderTest
 (super org/bouncycastle2/util/test/SimpleTest)
 (source "CertPathBuilderTest.java")


(method (attrs public ) <init>()void
  (limit registers 1)
  ; this: v0 ([object org/bouncycastle2/jce/provider/test/CertPathBuilderTest])
  (line 29)
  (invoke-direct {v0} org/bouncycastle2/util/test/SimpleTest/<init> )
  (return-void )
 )

(method (attrs private ) baseTest()void
  (annotation systemVisibility [object dalvik/annotation/Throws]
    (value [array [object java/lang/String]] [object java/lang/Exception])
  )
  (limit registers 26)
  ; this: v25 ([object org/bouncycastle2/jce/provider/test/CertPathBuilderTest])
  (line 36)
  (const-string v4 "X.509")
  (const-string v5 "BC2")
  (invoke-static {v4 v5} java/security/cert/CertificateFactory/getInstance [object java/lang/String] [object java/lang/String] )
  (move-result-object v11)
  (line 39)
  (new-instance v4 java/io/ByteArrayInputStream)
  (sget-object v5 org/bouncycastle2/jce/provider/test/CertPathTest.rootCertBin [array byte])
  (invoke-direct {v4 v5} java/io/ByteArrayInputStream/<init> [array byte] )
  (invoke-virtual {v11 v4} java/security/cert/CertificateFactory/generateCertificate [object java/io/InputStream] )
  (move-result-object v20)
  (check-cast v20 [object java/security/cert/X509Certificate])
  (line 40)
  (new-instance v4 java/io/ByteArrayInputStream)
  (sget-object v5 org/bouncycastle2/jce/provider/test/CertPathTest.interCertBin [array byte])
  (invoke-direct {v4 v5} java/io/ByteArrayInputStream/<init> [array byte] )
  (invoke-virtual {v11 v4} java/security/cert/CertificateFactory/generateCertificate [object java/io/InputStream] )
  (move-result-object v14)
  (check-cast v14 [object java/security/cert/X509Certificate])
  (line 41)
  (new-instance v4 java/io/ByteArrayInputStream)
  (sget-object v5 org/bouncycastle2/jce/provider/test/CertPathTest.finalCertBin [array byte])
  (invoke-direct {v4 v5} java/io/ByteArrayInputStream/<init> [array byte] )
  (invoke-virtual {v11 v4} java/security/cert/CertificateFactory/generateCertificate [object java/io/InputStream] )
  (move-result-object v13)
  (check-cast v13 [object java/security/cert/X509Certificate])
  (line 42)
  (new-instance v4 java/io/ByteArrayInputStream)
  (sget-object v5 org/bouncycastle2/jce/provider/test/CertPathTest.rootCrlBin [array byte])
  (invoke-direct {v4 v5} java/io/ByteArrayInputStream/<init> [array byte] )
  (invoke-virtual {v11 v4} java/security/cert/CertificateFactory/generateCRL [object java/io/InputStream] )
  (move-result-object v21)
  (check-cast v21 [object java/security/cert/X509CRL])
  (line 43)
  (new-instance v4 java/io/ByteArrayInputStream)
  (sget-object v5 org/bouncycastle2/jce/provider/test/CertPathTest.interCrlBin [array byte])
  (invoke-direct {v4 v5} java/io/ByteArrayInputStream/<init> [array byte] )
  (invoke-virtual {v11 v4} java/security/cert/CertificateFactory/generateCRL [object java/io/InputStream] )
  (move-result-object v15)
  (check-cast v15 [object java/security/cert/X509CRL])
  (line 44)
  (new-instance v16 java/util/ArrayList)
  (invoke-direct/range {v16} java/util/ArrayList/<init> )
  (line 45)
  (move-object/from16 v0 v16)
  (move-object/from16 v1 v20)
  (invoke-interface {v0 v1} java/util/List/add [object java/lang/Object] )
  (line 46)
  (move-object/from16 v0 v16)
  (invoke-interface {v0 v14} java/util/List/add [object java/lang/Object] )
  (line 47)
  (move-object/from16 v0 v16)
  (invoke-interface {v0 v13} java/util/List/add [object java/lang/Object] )
  (line 48)
  (move-object/from16 v0 v16)
  (move-object/from16 v1 v21)
  (invoke-interface {v0 v1} java/util/List/add [object java/lang/Object] )
  (line 49)
  (move-object/from16 v0 v16)
  (invoke-interface {v0 v15} java/util/List/add [object java/lang/Object] )
  (line 50)
  (new-instance v10 java/security/cert/CollectionCertStoreParameters)
  (move-object/from16 v0 v16)
  (invoke-direct {v10 v0} java/security/cert/CollectionCertStoreParameters/<init> [object java/util/Collection] )
  (line 51)
  (const-string v4 "Collection")
  (const-string v5 "BC2")
  (invoke-static {v4 v10 v5} java/security/cert/CertStore/getInstance [object java/lang/String] [object java/security/cert/CertStoreParameters] [object java/lang/String] )
  (move-result-object v22)
  (line 52)
  (invoke-static {} java/util/Calendar/getInstance )
  (nop )
  (move-result-object v3)
  (line 53)
  (const/16 v4 2008)
  (const/16 v5 8)
  (const/4 v6 4)
  (const/16 v7 14)
  (const/16 v8 49)
  (const/16 v9 10)
  (invoke-virtual/range {v3 .. v9} java/util/Calendar/set int int int int int int )
  (line 56)
  (new-instance v24 java/util/HashSet)
  (invoke-direct/range {v24} java/util/HashSet/<init> )
  (line 57)
  (new-instance v4 java/security/cert/TrustAnchor)
  (const/4 v5 0)
  (move-object/from16 v0 v20)
  (invoke-direct {v4 v0 v5} java/security/cert/TrustAnchor/<init> [object java/security/cert/X509Certificate] [array byte] )
  (move-object/from16 v0 v24)
  (invoke-interface {v0 v4} java/util/Set/add [object java/lang/Object] )
  (line 59)
  (const-string v4 "PKIX")
  (const-string v5 "BC2")
  (invoke-static {v4 v5} java/security/cert/CertPathBuilder/getInstance [object java/lang/String] [object java/lang/String] )
  (move-result-object v12)
  (line 60)
  (new-instance v23 java/security/cert/X509CertSelector)
  (invoke-direct/range {v23} java/security/cert/X509CertSelector/<init> )
  (line 61)
  (invoke-virtual {v13} java/security/cert/X509Certificate/getSubjectX500Principal )
  (move-result-object v4)
  (invoke-virtual {v4} javax/security/auth/x500/X500Principal/getEncoded )
  (move-result-object v4)
  (move-object/from16 v0 v23)
  (invoke-virtual {v0 v4} java/security/cert/X509CertSelector/setSubject [array byte] )
  (line 62)
  (new-instance v17 java/security/cert/PKIXBuilderParameters)
  (move-object/from16 v0 v17)
  (move-object/from16 v1 v24)
  (move-object/from16 v2 v23)
  (invoke-direct {v0 v1 v2} java/security/cert/PKIXBuilderParameters/<init> [object java/util/Set] [object java/security/cert/CertSelector] )
  (line 63)
  (move-object/from16 v0 v17)
  (move-object/from16 v1 v22)
  (invoke-virtual {v0 v1} java/security/cert/PKIXBuilderParameters/addCertStore [object java/security/cert/CertStore] )
  (line 64)
  (invoke-virtual {v3} java/util/Calendar/getTime )
  (move-result-object v4)
  (move-object/from16 v0 v17)
  (invoke-virtual {v0 v4} java/security/cert/PKIXBuilderParameters/setDate [object java/util/Date] )
  (line 65)
  (move-object/from16 v0 v17)
  (invoke-virtual {v12 v0} java/security/cert/CertPathBuilder/build [object java/security/cert/CertPathParameters] )
  (move-result-object v19)
  (check-cast v19 [object java/security/cert/PKIXCertPathBuilderResult])
  (line 66)
  (invoke-virtual/range {v19} java/security/cert/PKIXCertPathBuilderResult/getCertPath )
  (move-result-object v18)
  (line 68)
  (invoke-virtual/range {v18} java/security/cert/CertPath/getCertificates )
  (move-result-object v4)
  (invoke-interface {v4} java/util/List/size )
  (move-result v4)
  (const/4 v5 2)
  (if-eq v4 v5 l15cf96)
  (line 70)
  (const-string v4 "wrong number of certs in baseTest path")
  (move-object/from16 v0 v25)
  (invoke-virtual {v0 v4} org/bouncycastle2/jce/provider/test/CertPathBuilderTest/fail [object java/lang/String] )
  (label l15cf96)
  (line 72)
  (return-void )
 )

(method (attrs public static ) main([array [object java/lang/String]] )void
  (limit registers 2)
  ; parameter[0] : v1 ([array [object java/lang/String]])
  (line 137)
  (new-instance v0 org/bouncycastle2/jce/provider/BouncyCastleProvider)
  (invoke-direct {v0} org/bouncycastle2/jce/provider/BouncyCastleProvider/<init> )
  (invoke-static {v0} java/security/Security/addProvider [object java/security/Provider] )
  (line 139)
  (new-instance v0 org/bouncycastle2/jce/provider/test/CertPathBuilderTest)
  (invoke-direct {v0} org/bouncycastle2/jce/provider/test/CertPathBuilderTest/<init> )
  (invoke-static {v0} org/bouncycastle2/jce/provider/test/CertPathBuilderTest/runTest [object org/bouncycastle2/util/test/Test] )
  (line 140)
  (return-void )
 )

(method (attrs private ) v0Test()void
  (annotation systemVisibility [object dalvik/annotation/Throws]
    (value [array [object java/lang/String]] [object java/lang/Exception])
  )
  (limit registers 23)
  ; this: v22 ([object org/bouncycastle2/jce/provider/test/CertPathBuilderTest])
  (line 78)
  (invoke-static {} org/bouncycastle2/jce/provider/test/TestUtils/generateRSAKeyPair )
  (nop )
  (move-result-object v18)
  (line 79)
  (invoke-static {} org/bouncycastle2/jce/provider/test/TestUtils/generateRSAKeyPair )
  (nop )
  (move-result-object v9)
  (line 80)
  (invoke-static {} org/bouncycastle2/jce/provider/test/TestUtils/generateRSAKeyPair )
  (nop )
  (move-result-object v6)
  (line 82)
  (invoke-static/range {v18} org/bouncycastle2/jce/provider/test/TestUtils/generateRootCert [object java/security/KeyPair] )
  (move-result-object v17)
  (line 83)
  (invoke-virtual {v9} java/security/KeyPair/getPublic )
  (move-result-object v20)
  (invoke-virtual/range {v18} java/security/KeyPair/getPrivate )
  (move-result-object v21)
  (move-object/from16 v0 v20)
  (move-object/from16 v1 v21)
  (move-object/from16 v2 v17)
  (invoke-static {v0 v1 v2} org/bouncycastle2/jce/provider/test/TestUtils/generateIntermediateCert [object java/security/PublicKey] [object java/security/PrivateKey] [object java/security/cert/X509Certificate] )
  (move-result-object v8)
  (line 84)
  (invoke-virtual {v6} java/security/KeyPair/getPublic )
  (move-result-object v20)
  (invoke-virtual {v9} java/security/KeyPair/getPrivate )
  (move-result-object v21)
  (move-object/from16 v0 v20)
  (move-object/from16 v1 v21)
  (invoke-static {v0 v1 v8} org/bouncycastle2/jce/provider/test/TestUtils/generateEndEntityCert [object java/security/PublicKey] [object java/security/PrivateKey] [object java/security/cert/X509Certificate] )
  (move-result-object v5)
  (line 86)
  (const-wide/16 v20 2)
  (invoke-static/range {v20 .. v21} java/math/BigInteger/valueOf long )
  (move-result-object v15)
  (line 87)
  (invoke-virtual/range {v18} java/security/KeyPair/getPrivate )
  (move-result-object v20)
  (move-object/from16 v0 v17)
  (move-object/from16 v1 v20)
  (invoke-static {v0 v1 v15} org/bouncycastle2/jce/provider/test/TestUtils/createCRL [object java/security/cert/X509Certificate] [object java/security/PrivateKey] [object java/math/BigInteger] )
  (move-result-object v16)
  (line 88)
  (invoke-virtual {v9} java/security/KeyPair/getPrivate )
  (move-result-object v20)
  (move-object/from16 v0 v20)
  (invoke-static {v8 v0 v15} org/bouncycastle2/jce/provider/test/TestUtils/createCRL [object java/security/cert/X509Certificate] [object java/security/PrivateKey] [object java/math/BigInteger] )
  (move-result-object v7)
  (line 91)
  (new-instance v10 java/util/ArrayList)
  (invoke-direct {v10} java/util/ArrayList/<init> )
  (line 93)
  (move-object/from16 v0 v17)
  (invoke-interface {v10 v0} java/util/List/add [object java/lang/Object] )
  (line 94)
  (invoke-interface {v10 v8} java/util/List/add [object java/lang/Object] )
  (line 95)
  (invoke-interface {v10 v5} java/util/List/add [object java/lang/Object] )
  (line 96)
  (move-object/from16 v0 v16)
  (invoke-interface {v10 v0} java/util/List/add [object java/lang/Object] )
  (line 97)
  (invoke-interface {v10 v7} java/util/List/add [object java/lang/Object] )
  (line 99)
  (new-instance v11 java/security/cert/CollectionCertStoreParameters)
  (invoke-direct {v11 v10} java/security/cert/CollectionCertStoreParameters/<init> [object java/util/Collection] )
  (line 100)
  (const-string v20 "Collection")
  (move-object/from16 v0 v20)
  (invoke-static {v0 v11} java/security/cert/CertStore/getInstance [object java/lang/String] [object java/security/cert/CertStoreParameters] )
  (move-result-object v19)
  (line 103)
  (const-string v20 "PKIX")
  (const-string v21 "BC2")
  (invoke-static/range {v20 .. v21} java/security/cert/CertPathBuilder/getInstance [object java/lang/String] [object java/lang/String] )
  (move-result-object v4)
  (line 104)
  (new-instance v13 java/security/cert/X509CertSelector)
  (invoke-direct {v13} java/security/cert/X509CertSelector/<init> )
  (line 106)
  (invoke-virtual {v5} java/security/cert/X509Certificate/getSubjectX500Principal )
  (move-result-object v20)
  (invoke-virtual/range {v20} javax/security/auth/x500/X500Principal/getEncoded )
  (move-result-object v20)
  (move-object/from16 v0 v20)
  (invoke-virtual {v13 v0} java/security/cert/X509CertSelector/setSubject [array byte] )
  (line 108)
  (new-instance v3 java/security/cert/PKIXBuilderParameters)
  (new-instance v20 java/security/cert/TrustAnchor)
  (const/16 v21 0)
  (move-object/from16 v0 v20)
  (move-object/from16 v1 v17)
  (move-object/from16 v2 v21)
  (invoke-direct {v0 v1 v2} java/security/cert/TrustAnchor/<init> [object java/security/cert/X509Certificate] [array byte] )
  (invoke-static/range {v20} java/util/Collections/singleton [object java/lang/Object] )
  (move-result-object v20)
  (move-object/from16 v0 v20)
  (invoke-direct {v3 v0 v13} java/security/cert/PKIXBuilderParameters/<init> [object java/util/Set] [object java/security/cert/CertSelector] )
  (line 110)
  (move-object/from16 v0 v19)
  (invoke-virtual {v3 v0} java/security/cert/PKIXBuilderParameters/addCertStore [object java/security/cert/CertStore] )
  (line 111)
  (new-instance v20 java/util/Date)
  (invoke-direct/range {v20} java/util/Date/<init> )
  (move-object/from16 v0 v20)
  (invoke-virtual {v3 v0} java/security/cert/PKIXBuilderParameters/setDate [object java/util/Date] )
  (line 113)
  (invoke-virtual {v4 v3} java/security/cert/CertPathBuilder/build [object java/security/cert/CertPathParameters] )
  (move-result-object v14)
  (check-cast v14 [object java/security/cert/PKIXCertPathBuilderResult])
  (line 114)
  (invoke-virtual {v14} java/security/cert/PKIXCertPathBuilderResult/getCertPath )
  (move-result-object v12)
  (line 116)
  (invoke-virtual {v12} java/security/cert/CertPath/getCertificates )
  (move-result-object v20)
  (invoke-interface/range {v20} java/util/List/size )
  (move-result v20)
  (const/16 v21 2)
  (move/from16 v0 v20)
  (move/from16 v1 v21)
  (if-eq v0 v1 l15d18a)
  (line 118)
  (const-string v20 "wrong number of certs in v0Test path")
  (move-object/from16 v0 v22)
  (move-object/from16 v1 v20)
  (invoke-virtual {v0 v1} org/bouncycastle2/jce/provider/test/CertPathBuilderTest/fail [object java/lang/String] )
  (label l15d18a)
  (line 120)
  (return-void )
 )

(method (attrs public ) getName()[object java/lang/String]
  (limit registers 2)
  ; this: v1 ([object org/bouncycastle2/jce/provider/test/CertPathBuilderTest])
  (line 131)
  (const-string v0 "CertPathBuilder")
  (return-object v0)
)

(method (attrs public ) performTest()void
  (annotation systemVisibility [object dalvik/annotation/Throws]
    (value [array [object java/lang/String]] [object java/lang/Exception])
  )
  (limit registers 1)
  ; this: v0 ([object org/bouncycastle2/jce/provider/test/CertPathBuilderTest])
  (line 125)
  (invoke-direct {v0} org/bouncycastle2/jce/provider/test/CertPathBuilderTest/baseTest )
  (line 126)
  (invoke-direct {v0} org/bouncycastle2/jce/provider/test/CertPathBuilderTest/v0Test )
  (line 127)
  (return-void )
)

)
